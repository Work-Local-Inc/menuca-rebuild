'use strict';var b;
(function(f){function y(a){return a.getHours().toString().padStart(2,"0")+":"+a.getMinutes().toString().padStart(2,"0")+" "+a.getDate()+" "+I[a.getMonth()]}function x(a){return a.getHours().toString().padStart(2,"0")+":"+a.getMinutes().toString().padStart(2,"0")}function C(a){return a.getDate()+" "+I[a.getMonth()]+", "+a.getFullYear()}function v(a){$(a).removeClass("flash");$(a).addClass("flash");setTimeout(()=>$(a).removeClass("flash"),550)}function B(a,c){const e={lh:0,cp:!0,bi:0,bj:0,bk:0,bl:0};
a=Math.floor((a-c)/1E3);e.lh=a;e.cp=0<=a;a=Math.abs(a);e.bi=a%60;e.bj=Math.floor(a/60)%60;e.bk=Math.floor(a/60/60)%24;e.bl=Math.floor(a/60/60/24);return e}function A(){return Math.floor((new Date).getTime()/1E3)}f.d={TOO_BUSY:"Too busy",UNAVAILABLE:"Unavailable item",UNABLE_TO_DELIVER:"Cannot deliver",UNKNOWN_ADDRESS:"Unknown address",DONT_DELIVER_TO_AREA:"Don't deliver to area",TIME_UNAVAILABLE:"Time unavailable"};class D{constructor(a){this.s=a;this.f=cjt.createElement("div",null,this.g=cjt.createElement("div",
{class:"reject-buttons"}),this.h=cjt.createElement("button",{class:"reject-confirm disabled",onclick:()=>this.r()},"CONFIRM"));for(let a in f.d)this.n(a,f.d[a]);this.k=new P(this.f)}n(a,c){let e=cjt.createElement("button",null,c);e.onclick=()=>this.q(e,a);this.g.appendChild(e)}q(a,c){this.j==c?(this.j=null,$(a).removeClass("selected"),$(this.h).addClass("disabled")):(this.j=c,$(".selected",this.g).removeClass("selected"),$(a).addClass("selected"),$(this.h).removeClass("disabled"));return!1}r(){this.j&&
(this.s(this.j),this.k.t());return!1}}f.E=D;class J{constructor(a){this.f=cjt.createElement("span",{class:"timer"},this.g=cjt.createElement("span",null));this.ba=a&&1E3*a.w||(new Date).getTime();this.bb=setInterval(()=>this.bd(),1E3);a&&a.v&&$(this.f).addClass(a.v);this.w=!(!a||!a.w);this.bc=a&&a.x;this.bd()}bd(){this.be((new Date).getTime())}be(a){a=Math.floor((a-this.ba)/1E3);let c=0>a;a=Math.abs(a);var e=a%60;let g=Math.floor(a/60/60)%24,d=Math.floor(a/60/60/24);e=(Math.floor(a/60)%60).toString().padStart(2,
"0")+":"+e.toString().padStart(2,"0");if(g||d)e=g.toString().padStart(2,"0")+":"+e,d&&(e=d.toString()+"d "+e);this.w&&!c&&(e="-"+e,$(this.f).addClass("countdown-overflow"),this.bc&&this.bc(!0));this.g.innerText=e;!this.w&&60<=a&&$(this.f).addClass("old")}bm(){clearInterval(this.bb)}bn(a){this.ba=1E3*a}bo(a){stop();$(this.f).removeClass("countdown-overflow");this.bc&&this.bc(!1);this.be(1E3*a)}}f.Z=J;class L{constructor(a,c){this.f=cjt.createElement("div",Object.assign({onclick:()=>this.bx()},c),...a);
this.br=new WeakMap;for(let c of a)this.br.set(c,c.style.display);this.bt();this.bx()}bt(){let a=null,c=this.f.firstElementChild;for(;c;)this.bw(c)&&("none"!=c.style.display&&(a=c),c.style.display="none"),c=c.nextElementSibling;return a}bx(){var a=this.bt();if(a=null==a||a==this.ca()?this.cb():this.cc(a))a.style.display=this.br.get(a)}bw(a){return"style"in a}cb(){let a=this.f.firstElementChild;for(;a;){if(this.bw(a))return a;a=a.nextElementSibling}return null}ca(){let a=this.f.lastElementChild;for(;a;){if(this.bw(a))return a;
a=a.previousElementSibling}return null}cc(a){let c=a.nextElementSibling;for(;c!=a;){if(this.bw(c))return c;c=c.nextElementSibling;c||(c=a.parentElement.firstElementChild)}return a}}f.Bq=L;class E{constructor(a){this.cj=a;let c=a.cj,e;this.f=cjt.createElement("div",{class:"bottom-dlg-container"},cjt.createElement("div",{class:"accept-dialog"},cjt.createElement("div",{class:"order-header"},cjt.createElement("div",{class:"icon"},cjt.createElement("img",{src:"/images/"+(1==c.delivery_type?"delivery.png":
"pickup.png")})),cjt.createElement("div",{class:"summary"},cjt.createElement("div",{class:"main"},cjt.createElement("span",{class:"order-type"},1==c.delivery_type?"DELIVERY":"PICKUP")),cjt.createElement("div",{class:"secondary"},"DUE ",e=cjt.createElement("span",null)," AT ",a.co.getHours()+":"+a.co.getMinutes().toString().padStart(2,"0"),cjt.createElement("br",null))),cjt.createElement("div",{class:"buttons"},cjt.createElement("a",{href:"#",class:"green",onclick:()=>a.cs()},"ACCEPT ORDER"),cjt.createElement("a",
{href:"#",class:"red",onclick:()=>this.cq()},"REJECT ORDER")))));e.innerText=this.cm();this.bb=setInterval(()=>{e.innerText=this.cm()},6E4)}cl(){clearInterval(this.bb);this.bb=0;this.f&&this.f.parentNode&&this.f.parentNode.removeChild(this.f);this.f=null}cm(){const a=B(this.cj.co.getTime(),(new Date).getTime());return a.cp?0==a.bl?"TODAY":1==a.bl?"TOMORROW":" IN "+a.bl+" DAYS":0==a.bl?"TODAY":1==a.bl?"YESTERDAY":a.bl+" DAYS AGO"}cq(){new D((a)=>this.cj.cq(a))}}f.Ch=E;class F{constructor(a){this.cj=
a;let c=a.cj,e,d;this.f=cjt.createElement("div",{class:"bottom-dlg-container"},cjt.createElement("div",{class:"ack-dialog"},cjt.createElement("div",{class:"order-header"},cjt.createElement("div",{class:"icon"},cjt.createElement("img",{src:"/images/"+(1==c.delivery_type?"delivery.png":"pickup.png")})),cjt.createElement("div",{class:"summary"},cjt.createElement("div",{class:"main"},cjt.createElement("span",{class:"order-type"},1==c.delivery_type?"DELIVERY":"PICKUP")),cjt.createElement("div",{class:"secondary"},
"DUE ",e=cjt.createElement("span",null)," AT ",a.co.getHours()+":"+a.co.getMinutes().toString().padStart(2,"0"),cjt.createElement("br",null))),cjt.createElement("div",{class:"buttons"},d=cjt.createElement("a",{href:"#",class:"green",onclick:()=>a.cz()})))));e.innerText=this.cm();this.bb=setInterval(()=>{e.innerText=this.cm()},6E4);this.cu=()=>d.innerText=this.cj.da==g.NEED_ACK?"PREPARE ORDER":"PREPARE EARLY";this.cu();a.cx.push(this.cu)}cl(){clearInterval(this.bb);this.bb=0;let a=this.cj.cx.findIndex((a)=>
a==this.cu);-1!=a&&this.cj.cx.splice(a,1);this.f&&this.f.parentNode&&this.f.parentNode.removeChild(this.f);this.f=null}cm(){const a=B(this.cj.co.getTime(),(new Date).getTime());return a.cp?0==a.bl?"TODAY":1==a.bl?"TOMORROW":" IN "+a.bl+" DAYS":0==a.bl?"TODAY":1==a.bl?"YESTERDAY":a.bl+" DAYS AGO"}}f.Ct=F;class d{constructor(a){this.cj=a;let c=a.cj,e;this.f=cjt.createElement("div",{class:"bottom-dlg-container"},cjt.createElement("div",{class:"done-dialog"},cjt.createElement("div",{class:"order-header"},
cjt.createElement("div",{class:"icon"},cjt.createElement("img",{src:"/images/"+(1==c.delivery_type?"delivery.png":"pickup.png")})),cjt.createElement("div",{class:"summary"},cjt.createElement("div",{class:"main"},cjt.createElement("span",{class:"order-type"},1==c.delivery_type?"DELIVERY":"PICKUP")),cjt.createElement("div",{class:"secondary"},"DUE ",e=cjt.createElement("span",null)," AT ",a.co.getHours()+":"+a.co.getMinutes().toString().padStart(2,"0"),cjt.createElement("br",null))),cjt.createElement("div",
{class:"buttons"},cjt.createElement("a",{href:"#",class:"blue",onclick:()=>a.dd()},"DONE")))));e.innerText=this.cm();this.bb=setInterval(()=>{e.innerText=this.cm()},6E4)}cl(){clearInterval(this.bb);this.bb=0;console.log(this.cj.cj.address.name);this.f&&this.f.parentNode&&this.f.parentNode.removeChild(this.f);this.f=null}cm(){const a=B(this.cj.co.getTime(),(new Date).getTime());return a.cp?0==a.bl?"TODAY":1==a.bl?"TOMORROW":" IN "+a.bl+" DAYS":0==a.bl?"TODAY":1==a.bl?"YESTERDAY":a.bl+" DAYS AGO"}}
f.Dc=d;class h{constructor(a){this.cj=a;var c=a.cj;const e=c.order.length;let d=8;c.price.tip||--d;c.price.convenience||--d;c.price.discount||--d;let h="",k,z,l=[];for(let a in c.price.taxes)l.push(cjt.createElement("tr",null,cjt.createElement("td",{class:"totals"},a,": "),cjt.createElement("td",{class:"price"},f.ee.format(c.price.taxes[a]))));this.f=cjt.createElement("div",{class:"order"},cjt.createElement("div",{class:"order-header"},cjt.createElement("div",{class:"icon"},cjt.createElement("img",
{src:"/images/"+(1==c.delivery_type?"delivery.png":"pickup.png")})),cjt.createElement("div",{class:"summary"},cjt.createElement("div",{class:"main"},c.address.name," | ",cjt.createElement("span",{class:"order-type"},1==c.delivery_type?"DELIVERY":"PICKUP")," | ","Order: ",c.id),k=cjt.createElement("div",{class:"secondary"})),cjt.createElement("div",{class:"due"},"Due at ",a.co.getHours()+":"+a.co.getMinutes().toString().padStart(2,"0"),cjt.createElement("br",null),(new M(a.el,"countdown")).f)),cjt.createElement("div",
{class:"payment"},cjt.createElement("span",{class:"method"},c.payment_method)," | ",c.payment_status?cjt.createElement("span",{class:"paid"},"PAID"):cjt.createElement("span",{class:"not-paid"},"NOT PAID")),cjt.createElement("table",null,cjt.createElement("tbody",null,c.order.map((c)=>{const e=[],d=a.dr(c),g=d?c.combo:c.type;if(d||h!=g)h=g,e.push(cjt.createElement("tr",{class:"item-category"},cjt.createElement("td",{colspan:"4"},g)));if(d)for(const a of c.items)this.dz(e,a);else this.dz(e,c);c.special_instructions&&
e.push(cjt.createElement("tr",null,cjt.createElement("td",{colspan:"4"},cjt.createElement("div",{class:"comment"},cjt.createElement("strong",null,"Special instructions: "),c.special_instructions))));return e}))),cjt.createElement("table",null,cjt.createElement("tfoot",null,cjt.createElement("tr",null,cjt.createElement("td",{rowspan:d,colspan:"2",class:"info-cell"},c.discount_code?cjt.createElement("div",{class:"promo-code"},cjt.createElement("span",{class:"title"},"Promo code: "),c.discount_code,
" (",cjt.createElement("span",{class:"value"},cjt.createElement("span",null,"-"),"$",c.price.discount),")"):null,c.comment?cjt.createElement("div",{class:"comment"},cjt.createElement("strong",null,"Comment: "),c.comment):null),cjt.createElement("td",{class:"totals"},"Subtotal: "),cjt.createElement("td",{class:"price"},f.ee.format(c.price.subtotal))),c.price.convenience?cjt.createElement("tr",null,cjt.createElement("td",{class:"totals"},"Convenience Fee: "),cjt.createElement("td",{class:"price"},f.ee.format(c.price.convenience))):
null,cjt.createElement("tr",null,cjt.createElement("td",{class:"totals"},"Delivery: "),cjt.createElement("td",{class:"price"},f.ee.format(c.price.delivery))),c.price.discount?cjt.createElement("tr",null,cjt.createElement("td",{class:"totals"},"Discount: "),cjt.createElement("td",{class:"price"},f.ee.format(c.price.discount))):null,c.price.tip?cjt.createElement("tr",null,cjt.createElement("td",{class:"totals"},"Tip: "),cjt.createElement("td",{class:"price"},f.ee.format(c.price.tip))):null,l,cjt.createElement("tr",
null,cjt.createElement("td",{class:"totals"},"Total: "),cjt.createElement("td",{class:"price"},f.ee.format(c.price.total))))),cjt.createElement("div",{class:"address"},cjt.createElement("strong",null,c.address.name),cjt.createElement("br",null),c.address.address1,c.address.address2?", "+c.address.address2:"",cjt.createElement("br",null),c.address.postal_code,cjt.createElement("br",null),c.address.phone,z=cjt.createElement("button",{class:"button slim print-button",onclick:()=>a.em()},cjt.createElement("span",
{class:"icon-printer",style:"margin-right: 5px; "})," Print")));c=()=>{k.innerText=e+" item"+(1<e?"s":"")+(a.da!=g.NEW?" - order "+this.dw():"")};const m=()=>{const a=this.cj.da!=g.NEW&&this.cj.da!=g.REJECTED;z.style.display=RTConfig.printing&&a?"":"none"};c();a.cx.push(c);this.ef();a.cx.push(()=>this.ef());m();a.cx.push(()=>m())}dz(a,c){a.push(cjt.createElement("tr",{class:"item"},cjt.createElement("td",{class:"qty"},c.qty+" x "),cjt.createElement("td",{colspan:"2",class:"details"},cjt.createElement("div",
{class:"name"},c.item)),cjt.createElement("td",{class:"price"},c.price?f.ee.format(c.price):"")));if(c.ingredients){let e=null,d="";for(const g of c.ingredients)(c=e&&(!g.type||g.type==d))&&$(e).addClass("merged"),d=g.type||"",c||a.push(cjt.createElement("tr",{class:"ingredient-details merged"},cjt.createElement("td",null),cjt.createElement("td",{colspan:"2"},cjt.createElement("div",{class:"ingredient-type"},g.type)),cjt.createElement("td",null))),e=cjt.createElement("tr",{class:"ingredient-details"},
cjt.createElement("td",null),cjt.createElement("td",{colspan:"2"},cjt.createElement("div",{class:"ingredient"},g.item)),cjt.createElement("td",null,g.price?f.ee.format(g.price):"")),a.push(e)}}ef(){this.cj.da==g.NEW?this.df||(this.df=new E(this.cj),this.f.appendChild(this.df.f)):this.df&&(this.df.cl(),this.df=null);this.cj.da==g.NEED_ACK||this.cj.da==g.PENDING?this.dg||(this.dg=new F(this.cj),this.f.appendChild(this.dg.f)):this.dg&&(this.dg.cl(),this.dg=null);this.cj.da==g.ACCACK?this.dh||(this.dh=
new d(this.cj),this.f.appendChild(this.dh.f)):this.dh&&(this.dh.cl(),this.dh=null)}dw(){const a=this.cj.cj;switch(a.status){case g.DONE:return"done "+this.eg(a.time_done);case g.PENDING:case g.NEED_ACK:return"pending";case g.ACCACK:return"accepted "+this.eg(a.time_accepted);case g.REJECTED:return"rejected "+this.eg(a.time_rejected);default:return console.log("ERR: Unknown status."),""}}eg(a){new Intl.DateTimeFormat("en",{weekday:"short"});let c=new Intl.DateTimeFormat("en",{month:"short"});a=new Date(1E3*
a);return c.format(a)+" "+a.getDate()+", "+a.getFullYear()+" at "+a.getHours()+":"+a.getMinutes().toString().padStart(2,"0")}}f.De=h;class k{constructor(a){this.cj=a;var c=a.cj;const e=c.order.length;let d;this.f=cjt.createElement("div",{class:"order-header",onclick:()=>a.eo&&a.eo()},cjt.createElement("div",{class:"icon"},cjt.createElement("img",{src:"/images/"+(1==c.delivery_type?"delivery.png":"pickup.png")})),cjt.createElement("div",{class:"summary"},cjt.createElement("div",{class:"main"},c.address.name,
" | ",cjt.createElement("span",{class:"order-type"},1==c.delivery_type?"DELIVERY":"PICKUP")," in ",(new M(a.el,"countdown")).f),cjt.createElement("div",{class:"order-no"},"Order No: ",c.id),d=cjt.createElement("div",{class:"secondary"})),cjt.createElement("div",{class:"arrow"},">"));c=()=>{d.innerText=e+" item"+(1<e?"s":"")+(a.da!=g.NEW?" - "+this.dw():"")};c();a.cx.push(c)}dw(){const a=this.cj.cj;switch(a.status){case g.DONE:return"order done "+this.eg(a.time_done);case g.PENDING:return"order pending";
case g.NEED_ACK:return"previously pending order - please acknowledge";case g.ACCACK:return"order accepted "+this.eg(a.time_accepted);case g.REJECTED:return"order rejected "+this.eg(a.time_rejected);default:return console.log("ERR: Unknown status."),""}}eg(a){new Intl.DateTimeFormat("en",{weekday:"short"});let c=new Intl.DateTimeFormat("en",{month:"short"});a=new Date(1E3*a);return c.format(a)+" "+a.getDate()+", "+a.getFullYear()+" at "+a.getHours()+":"+a.getMinutes().toString().padStart(2,"0")}}f.En=
k;class m{constructor(a){this.cj=a;var c=a.cj;let e;this.f=cjt.createElement("div",{class:"order-header",onclick:()=>a.eo&&a.eo()},e=cjt.createElement("div",{class:"status"}),cjt.createElement("div",{class:"summary"},cjt.createElement("div",{class:"main"},c.address.name," | ",cjt.createElement("span",{class:"order-type"},1==c.delivery_type?"DELIVERY":"PICKUP")),cjt.createElement("div",{class:"secondary"},this.eg(c.delivery_time))),cjt.createElement("div",{class:"order-no"},"Order No: ",c.id),cjt.createElement("div",
{class:"total"},f.ee.format(c.price.total)),cjt.createElement("div",{class:"arrow"},">"));c=()=>{if(a.da==g.DONE){$(e).addClass("done");for($(e).removeClass("rejected");e.childNodes.length;)e.removeChild(e.firstChild);e.append(cjt.createElement("span",{class:"icon icon-checkmark"})," Completed")}else{$(e).addClass("rejected");for($(e).removeClass("done");e.childNodes.length;)e.removeChild(e.firstChild);e.append(cjt.createElement("span",{class:"icon icon-cross"})," Rejected")}};c();a.cx.push(c)}eg(a){new Intl.DateTimeFormat("en",
{weekday:"short"});let c=new Intl.DateTimeFormat("en",{month:"short"});a=new Date(1E3*a);return c.format(a)+" "+a.getDate()+" - "+a.getHours()+":"+a.getMinutes().toString().padStart(2,"0")}}f.Ep=m;(function(a){(a.es||(a.es={})).et={preorder:"PRE ORDER",preorder_image:"preorder",delivery_star:"*** Delivery ***",pickup_star:"**** Pickup ****",requested_for:"Requested For",order:"Order",accepted_time:"Accepted Time",accepted_date:"Accepted Date",payment_status:"Payment Status",payment_method:"Payment Method",
paid:"PAID",not_paid:"NOT PAID",postal_code:"Postal Code",phone:"Phone",comments:"Comments",combo_comments:"Combo Comments",subtotal:"Subtotal",delivery:"Delivery",convenience:"Convenience Fee",tip:"Tip",total:"Total"};(a.ev||(a.ev={})).et={preorder:"PR\u00c9-COMMANDE",preorder_image:"preorder-fr",delivery_star:"** Livraison  **",pickup_star:"** Ramassage  **",requested_for:"Demand\u00e9 Pour",order:"Commande",accepted_time:"Temps Accept\u00e9",accepted_date:"Date Accept\u00e9e",payment_status:"Statut de Paiement",
payment_method:"Mode de Paiement",paid:"PAY\u00c9",not_paid:"IMPAY\u00c9",postal_code:"Code Postal",phone:"T\u00e9l\u00e9phone",comments:"Commentaires",combo_comments:"Combo Commentaires",subtotal:"Sous-total",delivery:"Livraison",convenience:"Convenience Fee",tip:"Pourboire",total:"Total"}})(f.er||(f.er={}));let g;(function(a){a[a.NEW=0]="NEW";a[a.PENDING=1]="PENDING";a[a.ACCACK=2]="ACCACK";a[a.REJECTED=3]="REJECTED";a[a.DONE=4]="DONE";a[a.NEED_ACK=5]="NEED_ACK"})(g=f.db||(f.db={}));new Intl.DateTimeFormat("en",
{weekday:"short"});new Intl.DateTimeFormat("en",{month:"short"});class n{constructor(a){this.fa=null;this.fb=t.NONE;this.fe=new cjt.ff(3E3);this.fl=this.fk=!1;this.cx=[];this.fm=[];this.fn=[];this.fo=[];this.fp=[];this.i=a.id;this.fv(a)}fq(a){a=JSON.parse(JSON.stringify(a));if(!a.ver||2>a.ver)for(const c of a.order){if(!this.dr(c)&&([c.item,c.type]=[c.type,c.item],c.ingredients))for(const a of c.ingredients)[a.item,a.type]=[a.type,a.item]}else switch(a.payment_method){case "1":a.payment_method="Cash";
break;case "2":a.payment_method="Credit Card";break;case "3":a.payment_method="Interac\u00ae";break;case "4":a.payment_method="Credit or Debit";break;case "904":a.payment_method="Credit Card at door";break;case "905":a.payment_method="Debit Card at door"}return a}dr(a){return"undefined"!=typeof a.combo}fv(a){this.cj=a=this.fq(a);var c=new Date;this.co=new Date(1E3*a.delivery_time);this.fg=Math.floor(this.co.getTime()-6E4*(RTConfig.delivery_time+6));app&&(app.fy(),app.fz(c.getTime()),app.fz(this.co.getTime()),
app.fz(this.fg),app.fz(RTConfig.delivery_time));this.fh=new G({ga:a.time_created,gb:!0});this.fj=new G;this.el=new G({ga:a.delivery_time,gb:!0});a.status!=g.NEW&&(this.fh.bo(a.time_accepted||a.time_rejected),a.status==g.ACCACK||a.status==g.DONE)&&(this.fj.bn(a.time_ack),a.status==g.DONE?(this.fj.bo(a.time_done),this.el.bo(a.time_done)):this.fj.gb());this.fg>c.getTime()||a.status==g.PENDING?(this.fl=this.fk=!0,cjt.gc(this.fg,()=>{this.fk=!1;this.cj.status==g.PENDING&&(this.cj.status=g.NEED_ACK,this.cx.forEach((a)=>
a()))})):this.fk=!1;a=(new h(this)).f;c=(new k(this)).f;let e=(new m(this)).f;this.ex&&$(this.ex).replaceWith(a);this.ey&&$(this.ey).replaceWith(c);this.ez&&$(this.ez).replaceWith(e);this.ex=a;this.ey=c;this.ez=e}get da(){return this.cj.status}gd(a,c){if(this.fd)if(this.fe.gj())this.fd.abort();else{Android.showToast("A previous operation is still running. Please try again in a moment.");return}this.fe.gk();let e=a.ge;this.fd=$.ajax("/action.php",{data:Object.assign({key:rt_key,order:this.i,action:e},
a.ci)}).done((a)=>{try{let d=JSON.parse(a);d.result?c():d.data?(this.fv(d.data),this.cx.forEach((a)=>a()),console.log("'"+e+"' action has failed. Order reloaded."),cjt.gl("'"+e+"' action has failed. Order reloaded.")):(console.log("'"+e+"' action has failed."),cjt.gl("'"+e+"' action has failed."))}catch(W){console.log("Failed to parse response:",W),cjt.gl("Failed to parse response.")}this.fd=null}).fail(()=>{console.log("'"+e+"' action has failed.");cjt.gl("'"+e+"' action has failed.");this.fd=null})}cs(){this.gd({ge:"accept",
ci:{pending:this.fk?1:0}},()=>{this.gm(this.fk);RTConfig.printing&&"1"==(Android.getPreference("receipt_autoprint")||"0")&&this.em()});return!1}cq(a){this.gd({ge:"reject",ci:{reason:a}},()=>this.go(a));return!1}cz(){this.gd({ge:"ack"},()=>this.gp());return!1}dd(){this.gd({ge:"done"},()=>this.gq());return!1}gm(a){this.fh.bm();this.cj.time_accepted=A();a?this.cj.status=g.PENDING:this.gp();this.fm.forEach((a)=>a());this.cx.forEach((a)=>a())}gp(){this.fj.gb();this.cj.status=g.ACCACK;this.cj.time_ack=
A();this.fn.forEach((a)=>a());this.cx.forEach((a)=>a())}go(a){this.fh.bm();this.el.bm();this.cj.status=g.REJECTED;this.cj.reject_reason=a;this.cj.time_rejected=A();this.fo.forEach((a)=>a());this.cx.forEach((a)=>a())}gq(){this.fj.bm();this.el.bm();this.cj.status=g.DONE;this.cj.time_done=A();this.fp.forEach((a)=>a());this.cx.forEach((a)=>a())}em(){if(this.da==g.NEW||this.da==g.REJECTED)Android.showToast("Orders that are not accepted cannot be printed out.");else{Android.showToast("Adding printing job...");
var a=this.cj,c="fr"==Android.getPreference("receipt_lang")?f.er.ev.et:f.er.es.et,e=Android.queryPrinterFeature(1)||32,d=Math.floor(e/2),h=new Q(this,"full",{charset:"ISO-8859-1",codepage:71});h.hi(parseInt(Android.getPreference("receipt_padding_top")||"0"));h.hj(cjt.hk(a.restaurant_name||RTConfig.name,d),{width:1});h.hj();h.hj(cjt.hk(1==a.delivery_type?c.delivery_star:c.pickup_star,d),{width:1});h.hj(cjt.hl("\n"+c.requested_for,e));h.hj(cjt.hk("> "+y(new Date(this.co)).padEnd(12," ")+" <",d),{width:1});
h.hj();var k=new cjt.gz(e),z=new Date(1E3*a.time_accepted);k.hn(c.order+":",this.i);k.hn(c.accepted_time+":",x(z));k.hn(c.accepted_date+":",C(z));k.hn(c.payment_status+":",a.payment_status?c.paid:c.not_paid);k.hn(c.payment_method+":",a.payment_method);a.payment_cc_ends&&k.hn("","**** "+a.payment_cc_ends);h.hj(k.hq());h.hj();this.fk&&(h.hr(c.preorder_image,{width:200,centered:!0}),h.hj());h.hj(this.cj.address.name,{bold:!0});h.hj(this.cj.address.address1);h.hj(this.cj.address.address2);h.hj(c.postal_code+
": "+a.address.postal_code);h.hj(c.phone+": "+a.address.phone);h.hj();a.comment&&(h.hs(c.comments+": ",{bold:!0}),h.hj(a.comment),h.hj());k=new cjt.gz(e,[{hc:1},{he:!0},{hc:1}]);z="";for(let e of a.order){const a=this.dr(e)?e.combo:e.type;a&&a!=z&&(k.hn("",a).ht.bold=!0);z=a||"";if(this.dr(e))for(const a of e.items)this.hu(k,a);else this.hu(k,e);e.special_instructions&&(k.hn("   ",this.dr(e)?c.combo_comments:c.comments).ht.bold=!0,k.hn("   ",e.special_instructions),k.hn())}k.em((a,c)=>h.hs(a,c));
h.hj();e=new cjt.gz(e,[{he:!0},{hc:1}]);e.hn(c.subtotal+":",f.hw.format(a.price.subtotal));a.price.convenience&&e.hn(c.convenience+":",f.hw.format(a.price.convenience));e.hn(c.delivery+":",f.hw.format(a.price.delivery));a.price.tip&&e.hn(c.tip+":",f.hw.format(a.price.tip));for(let c in a.price.taxes)e.hn(c+":",f.hw.format(a.price.taxes[c]));h.hj(e.hq()+"\n");h.hj(cjt.hx([[c.total+":",f.ee.format(a.price.total)]],d,[{he:!0},{hc:1}]),{width:1,height:1});h.hi(parseInt(Android.getPreference("receipt_padding_bottom")||
"0"));Android.queryPrinterFeature(0)?h.hs("\n\n"):h.hs("\n--------------------------------\n\n");pq.hy(h)}}hu(a,c){a.hn(c.qty+" x",c.item,f.hw.format(c.price));if(c.ingredients){let e=!0,d="";for(let g of c.ingredients)g.type&&g.type!=d&&(e||a.hn(),a.hn("   ",g.type).ht.bold=!0),d=g.type||"",c=1<g.qty?g.qty+" x":"   ",g.price?a.hn(c,g.item,f.hw.format(g.price)):a.hn(c,g.item),e=!1}a.hn()}}f.cr=n;let l;(function(a){a.bb=30;a.ig=5;a.ih=30;a.ii=300;a.ij=45;a.ik=120;a.il=function(){return Math.min(a.bb,
a.ig)};a.im=4;a.io=!0;a.ip=function(){return RTConfig.printing&&"1"==(Android.getPreference("order_autoaccept")||"0")}})(l=f.ie||(f.ie={}));class r{constructor(){this.f=cjt.createElement("div",{class:"clock"});this.bd()}bd(){let a=new Date;this.f.innerText=a.getHours().toString().padStart(2,"0")+":"+a.getMinutes().toString().padStart(2,"0")+":"+a.getSeconds().toString().padStart(2,"0");setTimeout(()=>this.bd(),1E3-a.getTime()%1E3+50)}}f.Iq=r;class p{constructor(a,c){this.f=cjt.createElement("span",
{class:"order-count"});this.iw=0;this.ix=[];let e;e=cjt.jf(a)?a:[a];a=()=>{let a=0;for(var d of e)a+=d.querySelectorAll(".order-header").length;c&&c.it?(d=f.jb.format(a)+c.it,c.iu&&1!=a&&(d+="s"),this.f.innerText=d):this.f.innerText=f.jb.format(a);if(a!=this.iw){this.iw=a;for(let c of this.ix)c(a)}};a();a=new MutationObserver(a);for(let d of e)a.observe(d,{childList:!0,subtree:c&&c.is})}get je(){return this.iw}}f.Iv=p;class q{constructor(a,c){this.jp=a;this.jq=c;this.jj={}}hy(a,c,e,d){return this.jn(a,
cjt.createElement("a",null,c),e,d)}jn(a,c,e,d){$(c).click(()=>this.jo(a));e.style.display="none";this.jj[a]={jk:c,jl:e};d&&d.v&&$(c).addClass(d.v);this.jp.appendChild(c);this.jq.appendChild(e);d&&d.gi&&this.jr(a,d.gi);(d&&d.jh||1==Object.keys(this.jj).length)&&this.jo(a);return c}js(a){this.jp.appendChild(a)}jt(a){if("undefined"!=typeof this.jj[a]){const c=this.jj[a];this.jp.removeChild(c.jk);c.jl.parentNode==this.jq&&this.jq.removeChild(c.jl);delete this.jj[a];$(c.jk).hasClass("selected")&&this.ju()}}fv(a,
c,e,d){this.jt(a);return this.hy(a,c,e,d)}jv(a,c){for(var e=0;e<this.jp.childNodes.length;++e){let c=this.jp.childNodes[e];"className"in c&&(c==a?$(c).addClass("selected"):$(c).removeClass("selected"))}for(a=0;a<this.jq.childNodes.length;++a)e=this.jq.childNodes[a],"style"in e&&(e.style.display=e==c?"":"none")}jo(a){this.jv(this.jj[a].jk,this.jj[a].jl);if("undefined"!=typeof this.jj[a].jm)for(const c of this.jj[a].jm)c()}ju(){for(let a in this.jj){this.jo(a);break}}jx(){for(let a in this.jj)if($(this.jj[a].jk).hasClass("selected"))return a;
return null}jy(a){let c;for(let e=0;e<this.jq.childNodes.length;++e){let d=this.jq.childNodes[e];"style"in d&&(d==a?(d.style.display="",c=!0):d.style.display="none")}c||(a.parentNode&&a.parentNode.removeChild(a),this.jq.appendChild(a))}jr(a,c){a=this.jj[a];"undefined"==typeof a.jm&&(a.jm=[]);a.jm.push(c)}}f.ji=q;let t;(function(a){a[a.NONE=0]="NONE";a[a.NEW=1]="NEW";a[a.ACK=2]="ACK"})(t=f.fc||(f.fc={}));class u{constructor(a,c,e){this.kq=a;this.kk=c;this.kd=this.kc=null;this.ke=1E4;this.kr(e);this.kl()}kf(a,
c,e=!1){this.kj();this.kk(!0);a=Android.notify(a,c,e);this.kl();return a}km(a,c=!1){const e=a.cj;a.fb!=t.NEW&&(this.ko(a),a.fa=this.kf("New order "+e.id,"<strong>For:</strong> "+e.address.name+"<br><strong>Total:</strong> "+f.ee.format(e.price.total),c),a.fb=t.NEW)}kp(a,c=!1){const e=a.cj;a.fb==t.ACK&&(this.ko(a),a.fa=this.kf("Pending order "+e.id,"<strong>For:</strong> "+e.address.name+"<br><strong>Total:</strong> "+f.ee.format(e.price.total),c),a.fb=t.ACK)}ko(a){null!==a.fa&&(Android.cancelNotification(a.fa),
a.fb=t.NONE)}kj(){null!==this.kc&&(clearTimeout(this.kc),this.kc=null);this.kd&&(Android.cancelNotification(this.kd),this.kd=null);this.kk(!1)}kl(){this.kj();this.kc=setInterval(()=>{this.kq()&&(this.kd&&Android.cancelNotification(this.kd),this.kk(!0),this.kd=Android.notify("Active order requires response!","There is an active order that has not received an answer.",!0))},this.ke)}kr(a){0!=a&&(this.ke=5E3<a?a:a*Math.floor(1E4/a))}}f.kb=u;class w{constructor(){this.f=cjt.createElement("div",{class:"section"},
cjt.createElement("div",{class:"title"},"Restaurant config:"),cjt.createElement("table",{class:"config-table indent"},cjt.createElement("tr",null,cjt.createElement("td",null,"We offer: "),cjt.createElement("td",null,this.kw=cjt.createElement("select",{name:"order_type"},cjt.createElement("option",{value:"3"},"Delivery & Takeout"),cjt.createElement("option",{value:"2"},"Delivery only"),cjt.createElement("option",{value:"1"},"Takeout only"),cjt.createElement("option",{value:"0"},"Nothing")))),this.kx=
cjt.createElement("tr",null,cjt.createElement("td",null,"Delivery time: "),cjt.createElement("td",null,this.kz=cjt.createElement("input",{name:"delivery_time",type:"number",style:"width: 3em"}))),this.ky=cjt.createElement("tr",null,cjt.createElement("td",null,"Takeout time: "),cjt.createElement("td",null,this.la=cjt.createElement("input",{name:"takeout_time",type:"number",style:"width: 3em"})))),cjt.createElement("div",{class:"buttons"},this.ku=cjt.createElement("button",{class:"button slim",onclick:()=>
this.bd()},"Save"),this.kv=cjt.createElement("button",{class:"button slim",onclick:()=>this.gk()},"Reset")));this.lb();this.gk()}lb(){let a=this.f.querySelectorAll("input, select, textarea"),c=()=>{this.lc();this.ld()};for(let e=0;e<a.length;++e){let d=a[e];d.addEventListener("change",c);d.addEventListener("keyup",c)}}lc(){let a=cjt.le(this.f),c=!1;for(let e in a)if("undefined"==typeof RTConfig[e]||a[e]!=RTConfig[e]){c=!0;break}this.ku.disabled=!c;this.kv.disabled=!c}gk(){cjt.lg(this.f,RTConfig);
this.ku.disabled=!0;this.kv.disabled=!0;this.ld();return!1}ld(){const a=parseInt(this.kw.value);this.kx.style.textDecoration=a&2?"":"line-through";this.ky.style.textDecoration=a&1?"":"line-through";this.kz.disabled=!(a&2);this.la.disabled=!(a&1)}bd(){let a=cjt.le(this.f);$.ajax("/update_config.php",{data:{key:rt_key,data:a}}).done((a)=>{try{let c=JSON.parse(a);if(c.ok){for(const a in c.config)RTConfig[a]=c.config[a];this.lc();Android.showToast("Update successful.")}else Android.showToast("Failed to perform update.")}catch(e){console.log("Failed to parse config update response:",
e),Android.showToast("Failed to parse response.",!0)}}).fail(()=>{console.log("Failed to update config.");Android.showToast("Failed to update configuration.",!0)})}}f.Kt=w;class R{constructor(a){this.ix=a;this.f=cjt.createElement("div",{class:"section"},cjt.createElement("div",{class:"title"},"Online ordering: ",this.da=cjt.createElement("span",null)),cjt.createElement("div",{class:"buttons"},this.lj=cjt.createElement("button",{class:"button slim",onclick:()=>this.ll(!0)},"Suspend"),this.lk=cjt.createElement("button",
{class:"button slim",onclick:()=>this.ll(!1)},"Resume")));this.bd()}bd(){this.lj.disabled=RTConfig.suspend_operation;this.lk.disabled=!RTConfig.suspend_operation;RTConfig.suspend_operation?(this.da.innerText="SUSPENDED",this.da.style.color="#900",this.da.style.fontWeight="bold"):(this.da.innerText="Enabled",this.da.style.color="#090",this.da.style.fontWeight="");return!1}ll(a){$.ajax("/update_config.php",{data:{key:rt_key,data:{suspend_operation:a?1:0}}}).done((a)=>{try{let c=JSON.parse(a);c.ok&&
"suspend_operation"in c.config?(RTConfig.suspend_operation=!!parseInt(c.config.suspend_operation),this.bd(),this.ix(),Android.showToast("Update successful.")):Android.showToast("Failed to perform update.")}catch(e){console.log("Failed to parse config update response:",e),Android.showToast("Failed to parse response.",!0)}}).fail(()=>{console.log("Failed to update config.");Android.showToast("Failed to update configuration.",!0)})}}f.Li=R;class S{constructor(a,c){this.cx=c;this.lr=JSON.parse(Android.getSelectedPrinter());
let e,d,g,h,k;this.f=cjt.createElement("div",Object.assign({},a),cjt.createElement("div",{class:"info"},cjt.createElement("table",null,cjt.createElement("tr",null,cjt.createElement("td",null,"Receipt language: "),cjt.createElement("td",null,e=cjt.createElement("select",null,cjt.createElement("option",{value:"en"},"English"),cjt.createElement("option",{value:"fr"},"French")))),cjt.createElement("tr",null,cjt.createElement("td",null,"Padding top: "),cjt.createElement("td",null,d=cjt.createElement("select",
null,cjt.createElement("option",{value:"0"},"None"),cjt.createElement("option",{value:"1"},"1 cm"),cjt.createElement("option",{value:"2"},"2 cm"),cjt.createElement("option",{value:"3"},"3 cm"),cjt.createElement("option",{value:"4"},"4 cm"),cjt.createElement("option",{value:"5"},"5 cm")))),cjt.createElement("tr",null,cjt.createElement("td",null,"Padding bottom: "),cjt.createElement("td",null,g=cjt.createElement("select",null,cjt.createElement("option",{value:"0"},"None"),cjt.createElement("option",
{value:"1"},"1 cm"),cjt.createElement("option",{value:"2"},"2 cm"),cjt.createElement("option",{value:"3"},"3 cm"),cjt.createElement("option",{value:"4"},"4 cm"),cjt.createElement("option",{value:"5"},"5 cm")))),cjt.createElement("tr",null,cjt.createElement("td",null,"Autoaccept: "),cjt.createElement("td",null,k=cjt.createElement("select",null,cjt.createElement("option",{value:"0"},"No"),cjt.createElement("option",{value:"1"},"Yes")))),cjt.createElement("tr",null,cjt.createElement("td",null,"Autoprint: "),
cjt.createElement("td",null,h=cjt.createElement("select",null,cjt.createElement("option",{value:"0"},"No"),cjt.createElement("option",{value:"1"},"Yes"))))),cjt.createElement("br",null),cjt.createElement("table",null,cjt.createElement("tr",null,cjt.createElement("td",null,"Printer: "),cjt.createElement("td",null,this.ln=cjt.createElement("span",null))),cjt.createElement("tr",null,cjt.createElement("td",null,"Queue: "),cjt.createElement("td",null,this.lo=cjt.createElement("span",null))))),this.lp=
cjt.createElement("div",{class:"buttons"},this.lq=cjt.createElement("button",{class:"button slim",onclick:()=>this.lx()},"Change Printer"),this.lk=cjt.createElement("button",{class:"button slim",onclick:()=>pq.me(!0)},"Resume")));pq.ix.push((a)=>this.ma(a));this.ma(!1,!0);e.value=Android.getPreference("receipt_lang")||"en";e.addEventListener("change",()=>{Android.setPreference("receipt_lang",e.value)});d.value=Android.getPreference("receipt_padding_top")||"0";d.addEventListener("change",()=>{Android.setPreference("receipt_padding_top",
d.value)});g.value=Android.getPreference("receipt_padding_bottom")||"0";g.addEventListener("change",()=>{Android.setPreference("receipt_padding_bottom",g.value)});h.value=Android.getPreference("receipt_autoprint")||"0";h.addEventListener("change",()=>{Android.setPreference("receipt_autoprint",h.value)});k.value=Android.getPreference("order_autoaccept")||"0";k.addEventListener("change",()=>{Android.setPreference("order_autoaccept",k.value)})}lx(){this.lp.style.display="none";let a=new T((c,e)=>{c&&
(Android.selectPrinter(e.name,e.address),this.lr=e,this.ln.innerText=e.name+" ("+e.address+")",this.cx());$(a.f).remove();this.lp.style.display=""},this.lr);this.f.appendChild(a.f);return!1}ma(a,c=!1){!a||this.lr&&this.lr.name||(this.lr=JSON.parse(Android.getSelectedPrinter()),c=!0);Android.hasBluetooth()?(c&&(this.ln.innerText=this.lr&&this.lr.name?this.lr.name+" ("+this.lr.address+")":"No printer selected."),this.lp.style.display=""):(this.ln.innerText="Cannot access the bluetooth adapter.",this.lp.style.display=
"none");this.lo.innerText=pq.mc()+" in queue. "+(pq.md()?"Printing...":"Not printing.");this.lk.style.display=pq.mc()&&!pq.md()?"":"none"}}f.Lm=S;let H;(function(a){async function c(a){return new Promise((c,e)=>{mj(Android.ping(a)).then((a)=>{0==a||"string"!==typeof a?c(-1):(a=a.match(/time=(\d+)/))?c(parseInt(a[1])):c(-1)}).catch(()=>c(-1))})}a.mg=c;const e="tablet.menu.ca google.com ns0.1984.is ns1.1984.is ns1.1984hosting.com ns2.1984.is ns2.1984hosting.com".split(" ");class d{constructor(){this.mp=
[];this.mq=[];this.mr=[];this.ms=[];this.mt=!1;this.nq();setInterval(async()=>{this.mq.push({ts:(new Date).getTime(),time:await c("tablet.menu.ca")});300<this.mq.length&&this.mq.shift()},1E4);setInterval(async()=>{this.mr.push({ts:(new Date).getTime(),time:await c("google.com")});300<this.mr.length&&this.mr.shift()},1E4)}mu(a){this.mp.push({ts:(new Date).getTime(),time:a});300<this.mp.length&&this.mp.shift()}async mw(a,c=null){return new Promise(async(d,g)=>{g=(new Date).getTime();var h=await Promise.all(e.map((a)=>
mj(Android.resolve(a))));const k=(new Date).getTime(),f={};for(var l=0;l<e.length;++l)f[e[l]]=h[l];h=JSON.parse(Android.getWifiStatus());l=(new Date).getTime();this.ms.push({ts:g,reason:a,req:this.mp,ph:this.mq,pg:this.mr,hosts:f,ts_hosts:k,wifi:h,ts_end:l,payload:c});this.nf();this.mp=[];this.mq=[];this.mr=[];this.ng();d()})}ng(){if(!this.mt){var a=()=>{if(0!=this.ms.length){this.mt=!0;var a=[],e=0;for(const c of this.ms){const d=JSON.stringify(c).length;if(0==a.length||4E6>e+d)a.push(c),e+=d;else break}$.ajax("/diagnostics.php?"+
cjt.no({key:rt_key,sw_ver:np,api_ver:rt_api_version}),{method:"POST",data:{snapshots:JSON.stringify(a)}}).done((a)=>{try{let e=JSON.parse(a);e&&e.success?(this.ms.splice(0,e.items),this.nf()):console.log("Failed to send diagnostics.");c()}catch(X){console.log("Failed to parse diagnostic response: ",X),c()}}).fail(()=>{console.log("Failed to send diagnostics.");c()})}};var c=()=>{this.ms.length?setTimeout(a,5E3):this.mt=!1};a()}}nf(){Android.setPreference("diagnostics",JSON.stringify(this.ms))}nq(){try{const a=
Android.getPreference("diagnostics");this.ms=a&&JSON.parse(a)||[];this.ms.length&&this.ng()}catch(z){}}}a.mo=d;class g{constructor(){window.addEventListener("error",(a)=>{try{let c=this.nu(a);app.od.mw("error",c)}catch(aa){console.log("Error handling failed.")}})}nu(a){let c={};if("object"==typeof a){if("undefined"!=typeof a.name&&(c.cg=a.name),"undefined"!=typeof a.message?c.ny=a.message:"undefined"!=typeof a.description&&(c.ny=a.description),"undefined"!=typeof a.filename?c.nz=a.filename:"undefined"!=
typeof a.fileName&&(c.nz=a.fileName),"undefined"!=typeof a.lineno?c.oa=a.lineno:"undefined"!=typeof a.lineNumber&&(c.oa=a.lineNumber),"undefined"!=typeof a.colno?c.ob=a.colno:typeof a.columnNumber&&(c.ob=a.columnNumber),"undefined"!=typeof a.stack&&(c.oc=a.stack),"object"==typeof a.error&&null!==a.error){a=this.nu(a.error);for(let e in a)!c[e]&&a[e]&&(c[e]=a[e])}}else c.ny=new String(a);return c}}a.ns=g;class h{constructor(a=200){this.oi=a;this.ci=[]}hy(a){this.ci.push({bg:Math.floor((new Date).getTime()/
1E3),ny:a});this.oh()}oh(){this.ci.length>this.oi&&this.ci.splice(0,this.ci.length-this.oi)}oj(){return this.ci.length}}a.og=h})(H=f.mf||(f.mf={}));class Y{constructor(a){this.ov=!0;this.ox=0;this.oz=null;this.pf=[];Android.setScreenAlwaysOn(!0);this.ow=new u(()=>0<this.om.querySelectorAll(".order-header").length,(a)=>a&&$(this.ol).addClass("shake"),Android.getRingtoneDuration());this.od=new H.mo;new H.ns;l.io&&(this.ii=new cjt.pd(l.ii,()=>{this.od.mw("watchdog");Android.showToast("Something went wrong. Resetting app...",
!0);Android.reload()}),this.ii.gb());this.pc=new cjt.pd(l.ij,()=>{this.qg(!1);Android.showToast("Resetting wifi, please wait...",!0);Android.setWifiState(!1);Android.setWifiState(!0)});this.pe=new cjt.pd(l.ik,()=>{this.qg(!1);this.qv(!0)});this.pa=new cjt.pb(l.ih,!0,()=>{this.od.mw("failure")});var c,e;this.f=cjt.createElement("main",null,c=cjt.createElement("div",{id:"tabs"}),e=cjt.createElement("div",{id:"content"}));this.jj=new q(c,e);this.jj.js(cjt.createElement("a",{class:"logo"},cjt.createElement("img",
{src:"/images/logo.svg"})));{let a,d,g;c=cjt.createElement("div",null,a=cjt.createElement("div",null,this.oq=cjt.createElement("div",{class:"new-count"}),this.om=cjt.createElement("div",null)),d=cjt.createElement("div",null,this.or=cjt.createElement("div",{class:"active-count"}),this.on=cjt.createElement("div",null)),g=cjt.createElement("div",null,this.os=cjt.createElement("div",{class:"pending-count"}),this.oo=cjt.createElement("div",null)));const h=new p(this.om,{it:" New Order",iu:!0});this.oq.appendChild(h.f);
const k=new p(this.on,{it:" Active Order",iu:!0});this.or.appendChild(k.f);const f=new p(this.oo,{it:" Pending Order",iu:!0});this.os.appendChild(f.f);let l=0;const m=cjt.createElement("span",{class:"order-count"},"0");this.ol=this.jj.hy("current",[cjt.createElement("span",{class:"icon-orders"}),m],c);c=()=>{let a;0<h.je?(a=!0,m.innerText=h.je,$(m).addClass("new"),$(m).removeClass("active pending"),h.je>l&&v(this.ol)):0<f.je?(a=!0,m.innerText=f.je,$(m).addClass("pending"),$(m).removeClass("new active")):
(a=0<k.je,m.innerText=k.je,$(m).addClass("active"),$(m).removeClass("new pending"));l=h.je;m.style.right=-$(m).outerWidth(!1)/2+"px";m.style.display=a?"block":"none"};e=()=>{g.style.display=0==f.je?"none":"";a.style.display=0==h.je?"none":"";d.style.display=(0<h.je||0<f.je)&&0==k.je?"none":""};h.ix.push(c,e);k.ix.push(c,e);f.ix.push(c,e);e()}{let g=cjt.createElement("div",{class:"subtabs-main"},c=cjt.createElement("div",{class:"subtabs-tabs"}),e=cjt.createElement("div",{class:"subtabs-content"}));
this.jj.hy("history",cjt.createElement("span",{class:"icon-history"}),g);this.oy=new q(c,e);this.op=cjt.createElement("div",{class:"history"});let h=new N(this.jj,-1,!1),k=new N(this.jj,-2,!1);this.oy.hy("session","Session",this.op);this.oy.hy("yesterday","Yesterday",h.f,{gi:()=>h.rk()});this.oy.hy("2days","2 Days Ago",k.f,{gi:()=>k.rk()});for(var d of a)this.hy(d);cjt.rl(0,0,1,()=>{h.rm();k.rm();this.oy.jo(this.oy.jx())})}{a=()=>{Android.hasPrinter()?$(this.f).removeClass("no-printer"):$(this.f).addClass("no-printer")};
ri&&(this.oz=cjt.createElement("div",null));e=cjt.createElement("div",{class:"subtabs-main"},d=cjt.createElement("div",{class:"subtabs-tabs"},cjt.createElement("div",{class:"corner-data"},cjt.createElement("div",{class:"device-id"},"Device ID: ",rt_designator),(new r).f)),c=cjt.createElement("div",{class:"subtabs-content settings"}));this.jj.hy("settings",cjt.createElement("span",{class:"icon-settings"}),e);d=new q(d,c);RTConfig.printing&&d.hy("receipt","Receipt",(new S({class:"section"},a)).f);d.hy("config-edit",
"Config",cjt.createElement("div",null,RTConfig.config_edit?(new w).f:null,(new R(()=>this.rb(RTConfig.suspend_operation,!1))).f));const g=new U;this.pf.push(()=>g.bm());d.hy("misc","Misc",cjt.createElement("div",{class:"section"},g.f))}this.jj.jn("t2p",cjt.createElement("a",{class:"t2p"},cjt.createElement("img",{src:"/images/tspay-grey.png",class:"normal"}),cjt.createElement("img",{src:"/images/tspay-blue.png",class:"selected"})),cjt.createElement("iframe",{src:"https://dashboard.text2pay.me/"}));
(0==this.om.childNodes.length||l.io)&&this.qd();RTConfig.suspend_operation&&this.rb(!0,!0);this.od.mw("startup")}qd(){const a=(new Date).getTime();l.io&&this.ii.gk();this.pc.gb();this.pe.gb();$.ajax("/get_orders.php",{data:{key:rt_key,sw_ver:np,api_ver:rt_api_version}}).done((c)=>{const e=(new Date).getTime();this.od.mu(e-a);this.pc.bm();this.pe.bm();this.qg(!0,e-a);try{const a=JSON.parse(c);a.command&&this.qh(a.command);this.qi(a.not_configured);a.id&&this.hy(a,!0);a.id&&!l.io||this.qj(a.next_fetch||
l.bb)}catch(K){console.log("Failed to parse new orders:",K),this.qj(l.bb)}}).fail(()=>{console.log("Failed to fetch new orders.");Android.showToast("Connection to the server has failed.",!0);this.qg(!1);this.qj(l.il())})}qj(a){clearTimeout(this.ox);this.ox=setTimeout(()=>this.qd(),1E3*a)}hy(a,c=!1){const e=new n(a);e.eo=()=>this.jj.jy(e.ex);e.cx.push(()=>this.ql(e));e.fo.push(()=>this.jj.jo("current"));this.ql(e,c);l.ip()&&e.da==g.NEW&&e.cs()}qm(a){let c,e,d=a.ey;switch(a.da){case g.NEW:case g.NEED_ACK:c=
this.om;e=!1;break;case g.PENDING:c=this.oo;e=!0;break;case g.REJECTED:case g.DONE:c=this.op;e=!0;d=a.ez;break;default:c=this.on,e=!0}let h=a.ey;a=a.ez;let k=h.parentNode||a.parentNode;c&&c!=k&&($(h).remove(),$(a).remove(),e?c.insertBefore(d,c.firstChild):c.appendChild(d));return[k,c]}ql(a,c=!0){let [e]=this.qm(a);c?a.da==g.NEW||l.ip()&&!a.fl&&a.da==g.ACCACK?this.ow.km(a):a.da==g.NEED_ACK?this.ow.kp(a):this.ow.ko(a):this.ow.ko(a);e!=this.om||this.om.childNodes.length||this.qj(0)}qh(a){switch(a){case "refresh":Android.reload();
break;case "diagnostics":this.od.mw("forced");break;default:console.log("Unknown command: "+a)}}qg(a,c){a?(this.qv(!1),this.ov||this.od.mw("recovery"),this.ov=!0,this.pa.bm()):(this.ov=!1,this.pa.gb())}qi(a){if(a){if(this.ot){if("not-configured"==this.ot.dt)return;this.ot.qw()}this.qx("not-configured",cjt.createElement("div",null,"This tablet is not configured.",cjt.createElement("br",null),cjt.createElement("br",null),"Please contact us at ",qy," to configure it.",cjt.createElement("br",null),cjt.createElement("br",
null),"Your tablet ID is: ",cjt.createElement("strong",null,rt_designator)))}else this.ot&&"not-configured"==this.ot.dt&&(this.qh("refresh"),this.ot.qz("Configuration successful. Please wait..."))}qv(a){if(a){if(this.ot){if("failed-request"==this.ot.dt)return;this.ot.qw()}this.qx("failed-request",cjt.createElement("div",null,"Connection to the server has failed.",cjt.createElement("br",null),cjt.createElement("br",null),"Please check your internet connection.",cjt.createElement("br",null),"If you're still having trouble, please contact us at ",
qy,".",cjt.createElement("br",null),cjt.createElement("br",null),"Your tablet ID is: ",cjt.createElement("strong",null,rt_designator)));this.ot.ra("MENU.CA connection problem.","Failed to communicate with the server. Please check your internet connection.")}else this.ot&&"failed-request"==this.ot.dt&&(this.ot.qw(),this.ot=null,Android.showToast("The connection has been reestablished."))}rb(a,c){if(a){if(this.ot){if("suspend-operation"==this.ot.dt)return;this.ot.qw()}this.qx("suspend-operation",cjt.createElement("div",
null,"Online ordering suspended.",cjt.createElement("br",null),cjt.createElement("br",null),"Re-enable online ordering from the settings section.",cjt.createElement("br",null),"If you're having trouble, please contact us at ",qy,".",cjt.createElement("br",null),cjt.createElement("br",null),"Your tablet ID is: ",cjt.createElement("strong",null,rt_designator)),c)}else this.ot&&"suspend-operation"==this.ot.dt&&(this.ot.qw(),this.ot=null,Android.showToast("Operation has been resumed."))}qx(a,c,e=!0){this.ot=
new V(a,c,{rf:()=>this.rg(),qw:()=>this.jj.jt("warning"),rh:!e});e||this.rg(!1)}rg(a=!0){$(".dismiss",this.ot.f).remove();this.jj.fv("warning",cjt.createElement("span",{class:"icon-warning"}),this.ot.f,{jh:a,v:"warning"})}fz(a){ri&&this.oz.appendChild(cjt.createElement("div",null,(new String(a)).toString()))}fy(){ri&&$(this.oz).children().remove()}onUnnotify(a){$(this.ol).removeClass("shake");if(-1==a||a===this.ow.kd)this.ow.kl(),this.pf.forEach((a)=>a())}back(){this.jj.jo(this.jj.jx())}onRingtoneChange(){this.ow.kr(Android.getRingtoneDuration())}}
f.Ok=Y;class N{constructor(a,c,e=!1){this.jj=a;this.rr=c;this.rq=e;this.f=cjt.createElement("div",{class:"history"});this.rn=cjt.createElement("div",{class:"indicator"},"Loading...")}rk(){if(!this.rq){this.rn.parentNode&&$(this.rn).remove();this.f.insertBefore(this.rn,null);var a=new Date;a.setDate(a.getDate()+this.rr);a.setHours(0,0,0,0);var c=new Date(a.getTime());c.setHours(23,59,59,999);$.ajax("/get_history.php",{data:{key:rt_key,sw_ver:np,api_ver:rt_api_version,start:Math.floor(a.getTime()/1E3),
end:Math.floor(c.getTime()/1E3)}}).done((a)=>{$(this.rn).remove();try{let c=JSON.parse(a);c.command&&app.qh(c.command);for(let a of c.history){const c=new n(a);c.eo=()=>this.jj.jy(c.ex);this.f.insertBefore(c.ez,this.f.firstChild)}this.rq=!0}catch(K){Android.showToast("History data malformed."),console.log("Failed to parse history: ",K)}}).fail(()=>{Android.showToast("Faeild to fetch history data.");console.log("Failed to fetch history data.");$(this.rn).remove()})}}rm(){this.rs();this.rq=!1}rs(){$(this.f).empty()}}
f.Pw=N;class P{constructor(a){this.f=cjt.createElement("div",{class:"overlay",onclick:(a)=>this.rt(a)},cjt.createElement("div",{class:"dialog"},cjt.createElement("a",{class:"dlg-close-button",href:"#",onclick:()=>this.t()},"X"),a));document.body.appendChild(this.f)}t(){this.f.parentNode&&this.f.parentNode.removeChild(this.f);return!1}rt(a){a.target==this.f&&this.t()}}f.L=P;class V{constructor(a,c,e){this.dt=a;this.bp=e;this.rv=null;this.f=cjt.createElement("div",{class:"full-page-notification"},a=
cjt.createElement("div",{class:"logo"}),c,this.ny=cjt.createElement("div",{class:"message"}));e&&e.rf&&this.f.appendChild(cjt.createElement("button",{class:"dismiss",onclick:()=>this.rf()},"Dismiss"));e.rh?this.f.style.position="initial":document.body.appendChild(this.f);a.innerHTML=f.rx.ry}rf(){this.f.style.position="initial";this.bp.rf();return!1}qw(){null!==this.rv&&Android.cancelNotification(this.rv);this.f&&this.f.parentNode&&this.f.parentNode.removeChild(this.f);this.f=null;this.bp&&this.bp.qw&&
this.bp.qw()}qz(a){this.ny.textContent=a}ra(a,c){this.rv=Android.notify(a,c,!1)}}f.Ou=V;class T{constructor(a,c){this.si=a;this.se=c;this.rz=new O("Select a Bluetooth Device:",cjt.createElement("div",{class:"buttons"},this.sb=cjt.createElement("button",{class:"button slim",onclick:()=>this.t(!0)},"Apply"),cjt.createElement("button",{class:"button slim",onclick:()=>this.t(!1)},"Dismiss"),cjt.createElement("button",{class:"button slim",onclick:()=>this.sc(!0)},"Refresh"),cjt.createElement("button",
{class:"button slim",onclick:()=>Android.showBluetoothSettings()},"Pair")));this.f=this.rz.f;this.rz.ix=()=>this.sb.disabled=!1;this.sc()}sc(a=!1){a&&Android.showToast("Refreshing bluetooth device list.");this.sb.disabled=!0;this.rz.sg();a=JSON.parse(Android.getBTDevices());for(let c of a)a=this.se&&this.se.address==c.address,this.rz.hy(c.name,c,a),a&&(this.sb.disabled=!1)}t(a){a?this.si(!0,this.rz.jx()):this.si(!1);return!1}}f.Lz=T;class Q{constructor(a,c,e={}){this.cj=a;this.dt=c;this.bp=e;this.ci=
[]}hs(a,c){if(""!=a){var e=JSON.parse(JSON.stringify(this.bp));for(let a in c)e[a]=c[a];this.ci.push({dt:"text",ci:a,bp:e})}}hj(a="",c){this.hs(a+"\n",c)}hr(a,c){c=c?JSON.parse(JSON.stringify(c)):null;this.ci.push({dt:"image",ci:a,bp:c})}hi(a){0!=a&&this.hs("\n".repeat(Math.round(a/(l.im/10))))}}f.gx=Q;class Z{constructor(){this.sr=[];this.ss=!1;this.ix=[];this.fz=new H.og(200)}hy(a){this.fz.hy("Adding job "+a.cj.cj.id+". Queue: "+this.sr.length+". Printing: "+(this.ss?"true":"false"));if(1<=this.sr.length||
!Android.queryPrinterFeature(0)&&1<=this.sr.length)return this.fz.hy("Print queue full."),app&&app.od.mw("debug",this.fz.ci),this.ss?Android.showToast("Print queue full."):(Android.showToast("Print queue full. Trying to resume printing..."),this.me()),!1;0<=this.sr.findIndex((c)=>c.cj.i==a.cj.i&&c.dt==a.dt)?(this.fz.hy("Job already in queue."),this.ss?Android.showToast("This job is already in the print queue."):this.me(!0)):(this.sr.push(a),this.fz.hy("Job added."),this.me())}me(a=!1){this.fz.hy("Resuming... Queue: "+
this.sr.length+". Printing: "+(this.ss?"true":"false"));this.sr.length&&this.sw(a)}sw(a){this.ss||(a&&Android.showToast("Resuming printing...",!0),this.ss=!0,this.fz.hy("Starting async printing..."),this.ta(!1),(new Promise(async(a,e)=>{this.fz.hy("Ensuring printer connection...");if(await mj(Android.ensurePrinterConnection())){for(;this.sr.length;){let c=this.sr[0];this.fz.hy("Printing order "+c.cj.i+".");Android.showToast("Printing order "+c.cj.i+".");if(await this.sz(c))this.fz.hy("Order "+c.cj.i+
" done. Queue: "+this.sr.length+". Printing: "+(this.ss?"true":"false")),this.sr.splice(0,1),this.ta(!1);else{this.fz.hy("Failed to print order "+c.cj.i+".");a="Failed to print order "+c.cj.i+". Please check your printer and try to resume printing.";Android.showToast(a,!0);e(a);return}}this.fz.hy("Async printing done.");a()}else this.fz.hy("Failed to connect to the printer."),Android.showToast("Failed to connect to the printer. Please check your printer and try to resume printing.",!0),e("Failed to connect to the printer. Please check your printer and try to resume printing.")})).then(()=>
{this.ss=!1;this.ta(!1)}).catch(()=>{this.ss=!1;this.ta(!1)}))}async sz(a){this.fz.hy("Starting printer job "+a.cj.i+".");if(!await mj(Android.startPrinterJob()))return!1;for(const c of a.ci)if(this.fz.hy("Printing "+a.cj.i+"..."),!await mj(Android.print(c.dt,c.ci,JSON.stringify(c.bp))))return!1;this.fz.hy("Ending printer job "+a.cj.i+".");return await mj(Android.endPrinterJob())?!0:!1}onNotify(a){this.fz.hy("onNotify "+(a?"1":"0"));a&&this.me(!0);this.ta(a)}ta(a){for(let c of this.ix)c(a)}mc(){return this.sr.length}md(){return this.ss}}
f.sq=Z;(f.rx||(f.rx={})).ry='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n\x3c!-- Created with Inkscape (http://www.inkscape.org/) --\x3e\n\n<svg\n   xmlns:dc="http://purl.org/dc/elements/1.1/"\n   xmlns:cc="http://creativecommons.org/ns#"\n   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"\n   xmlns:svg="http://www.w3.org/2000/svg"\n   xmlns="http://www.w3.org/2000/svg"\n   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\n   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n   width="46.68816mm"\n   height="38.449078mm"\n   viewBox="0 0 46.68816 38.449078"\n   version="1.1"\n   id="svg8"\n   inkscape:version="0.92.4 (5da689c313, 2019-01-14)"\n   sodipodi:docname="logo_path.svg">\n  <defs\n     id="defs2" />\n  <sodipodi:namedview\n     id="base"\n     pagecolor="#ffffff"\n     bordercolor="#666666"\n     borderopacity="1.0"\n     inkscape:pageopacity="0.0"\n     inkscape:pageshadow="2"\n     inkscape:zoom="3.959798"\n     inkscape:cx="67.705324"\n     inkscape:cy="84.399564"\n     inkscape:document-units="mm"\n     inkscape:current-layer="layer1"\n     showgrid="false"\n     inkscape:window-width="1280"\n     inkscape:window-height="995"\n     inkscape:window-x="-9"\n     inkscape:window-y="59"\n     inkscape:window-maximized="1"\n     fit-margin-top="0"\n     fit-margin-left="0"\n     fit-margin-right="0"\n     fit-margin-bottom="0"\n     showborder="false" />\n  <metadata\n     id="metadata5">\n    <rdf:RDF>\n      <cc:Work\n         rdf:about="">\n        <dc:format>image/svg+xml</dc:format>\n        <dc:type\n           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />\n        <dc:title></dc:title>\n      </cc:Work>\n    </rdf:RDF>\n  </metadata>\n  <g\n     inkscape:label="Layer 1"\n     inkscape:groupmode="layer"\n     id="layer1"\n     transform="translate(-50.894497,-53.318748)">\n    <rect\n       style="fill:#db1f25;fill-opacity:1;stroke:none;stroke-width:0.0109896;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"\n       id="rect3713"\n       width="46.68816"\n       height="38.449078"\n       x="50.894497"\n       y="53.318748" />\n    <g\n       aria-label="M"\n       transform="scale(0.99867465,1.0013271)"\n       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:34.05560303px;line-height:1.25;font-family:Arial;-inkscape-font-specification:Arial;letter-spacing:0px;word-spacing:0px;fill:#ffffff;fill-opacity:1;stroke-width:2.32197332"\n       id="text4522">\n      <path\n         d="m 84.03164,84.685875 v -16.52894 q 0,-1.912302 0.249431,-4.722555 h -0.08314 q -0.39909,1.646243 -0.715035,2.311391 l -8.53053,18.940104 h -1.213896 l -8.5139,-18.807074 Q 64.891992,65.163767 64.526161,63.43438 h -0.08314 q 0.13303,0.91458 0.13303,4.672669 V 84.685875 H 61.965339 V 60.20841 h 3.508658 l 7.649208,17.243975 q 0.931208,2.095218 1.147381,2.893396 h 0.09977 q 0.24943,-0.681777 1.197267,-2.97654 L 83.399749,60.20841 h 3.309114 v 24.477465 z"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-family:\'Malgun Gothic\';-inkscape-font-specification:\'Malgun Gothic\';fill:#ffffff;fill-opacity:1;stroke-width:2.32197332"\n         id="path4561" />\n    </g>\n  </g>\n</svg>\n';
class U{constructor(){this.tf=[{name:"Sonar / Dining Room",file:"doublesonar"},{name:"Classic / Kitchen",file:"old_phone"}];this.td=new cjt.te;this.rz=new O("Select a Ringtone:");this.f=this.rz.f;const a=Android.getRingtone();for(const c of this.tf)this.rz.hy(c.name,c.file,c.file==a);this.rz.ix=(a)=>{this.td.tg("https://android_res/raw/"+a);this.td.th();Android.setRingtone(a)}}bm(){this.td.bm()}}f.Qc=U;f.ee=new Intl.NumberFormat("en-CA",{style:"currency",currency:"CAD"});f.jb=new Intl.NumberFormat("en-CA");
f.hw=new Intl.NumberFormat("en-CA",{minimumFractionDigits:2,maximumFractionDigits:2});const I="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");f.tj=function(a){return a.getHours().toString().padStart(2,"0")+":"+a.getMinutes().toString().padStart(2,"0")+" "+a.getDate()+" "+I[a.getMonth()]+", "+a.getFullYear()};f.hm=y;f.ho=x;f.hp=C;f.pt=v;f.cn=B;f.gs=A;class G{constructor(a){this.bf={lh:0,cp:!1,bi:0,bj:0,bk:0,bl:0};this.cx=[];let c=a&&a.gb;this.ba=1E3*(a&&a.ga||0);this.bd();c&&this.gb()}bd(){this.be((new Date).getTime())}be(a){this.bf=
B(a,this.ba);for(let a of this.cx)a(this)}gb(){this.bm();this.bb=setInterval(()=>this.bd(),1E3)}bm(){clearInterval(this.bb)}bn(a){this.ba=1E3*a}bo(a){this.bm();this.be(1E3*a)}ht(a){if(a&&a.tq)return a=this.bf,a.bl?a.bl+" days":a.bk?a.bk+" hours":a.bj?a.bj+" minutes":a.bi+" seconds";a=this.bf.bj.toString().padStart(2,"0")+":"+this.bf.bi.toString().padStart(2,"0");if(this.bf.bk||this.bf.bl)a=this.bf.bk.toString().padStart(2,"0")+":"+a,this.bf.bl&&(a=this.bf.bl.toString()+"d "+a);return a}}f.fi=G;class M{constructor(a,
c=""){this.ts=a;this.f=cjt.createElement("span",{class:c});a.cx.push(()=>this.bd());this.bd()}bd(){this.f.innerText=(this.ts.bf.cp?"-":"")+this.ts.ht({tq:!0})}}f.Ek=M;class O{constructor(a,c=null){c&&$(c).addClass("buttons");this.f=cjt.createElement("div",{class:"list-selector"},cjt.createElement("div",{class:"title"},a),this.rz=cjt.createElement("div",{class:"item-list"}),c)}hy(a,c,e=!1){let d="item";e&&(d+=" selected");a=cjt.createElement("div",{class:d},cjt.createElement("a",{onclick:()=>this.jo(c)},
a));$(a).data("data",JSON.stringify(c));this.rz.appendChild(a)}jo(a){let c=JSON.stringify(a);for(let e=0;e<this.rz.childNodes.length;++e){let d=this.rz.childNodes[e];$(d).data("data")==c?($(d).addClass("selected"),this.ix&&this.ix(a)):$(d).removeClass("selected")}return!1}jx(){return JSON.parse($(".selected",this.rz).data("data"))}sg(){$(this.rz).empty()}}f.Sa=O})(b||(b={}));var cjt;
(function(f){function y(d,h){if(!d.length)return"";if(d.length<=h)return" ".repeat(Math.floor((h-d.length)/2))+d;let k=d.split(" ");d=[];let m="";for(var g of k)if(m.length&&m.length+1+g.length>h&&(d.push(m),m=""),g.length>h){for(f.vt(0==m.length);g.length>h;)d.push(g.substr(0,h)),g=g.substr(h);g.length&&(m=g)}else m+=(m.length?" ":"")+g;m.length&&d.push(m);for(g=0;g<d.length;++g)d[g]=" ".repeat(Math.floor((h-d[g].length)/2))+d[g];return d.join("\n")}function x(d,h,...k){d=document.createElement(d);
if(h)for(var f in h)"function"==typeof h[f]?d[f]=h[f]:d.setAttribute(f,h[f]);if(k)for(let g of k)if(null!==g){if(Array.isArray(g)){h=[...g];for(k=[];h.length;)f=h.pop(),Array.isArray(f)?h.push(...f):k.push(f);g=k.reverse()}else g=[g];for(const h of g)"object"==typeof h?d.appendChild(h):d.appendChild(document.createTextNode(h))}return d}function C(d,h){const k=(new Date).getTime();d>k?setTimeout(h,d-k+100):h()}function v(d){d=encodeURIComponent(d);const h=d.match(/%[0-9a-f]/gi);return d.length-(h?
2*h.length:0)}class B{constructor(d){this.gi=d;this.p="";this.bp=null}hy(d,h){h=h||null;this.tx(h)&&(this.ty(),this.bp=h);this.p+=d}ty(){this.p&&this.gi(this.p,this.bp);this.p="";this.bp=null}tx(d){const h=this.bp||{};d=d||{};if(typeof h!=typeof d||Object.keys(h).length!=Object.keys(d).length)return!0;for(let k in h)if(h[k]!==d[k])return!0;return!1}}class A{constructor(){this.ub=[];this.ht={}}uc(d){"string"!=typeof d?this.ub.push(String(d)):this.ub.push(d)}}f.ua=A;class D{constructor(d,h=[]){this.ur=
d;this.vf=h;this.dj=[];this.ud=!1}hn(...d){let h=this.ue();for(let k of d)h.uc(k);return h}ue(){let d=new A;this.dj.push(d);return d}em(d){let h=[];var k=[],f=[];for(var g of this.dj){var n=0,l=[];for(var r=0;r<g.ub.length;++r){var p=g.ub[r],q=r==g.ub.length-1;p=this.ud?v(p):p.length;p+=q?0:1;l.push(p);n+=p}k.push(n);f.push(l);for(n=0;n<g.ub.length;++n)r=l[n],n==h.length?h.push(r):r>h[n]&&(h[n]=r)}k=g=0;for(l=0;l<h.length;++l)g+=h[l],this.vf.length>l&&this.vf[l].he&&++k;if(g>this.ur){g-=this.ur;if(k)for(l=
!0;g&&l;){l=!1;n=-1;r=0;for(q=0;q<h.length;++q)this.vf.length>q&&this.vf[q].he&&(p=h[q],p>r&&(n=q,r=p));0<=n&&(--h[n],--g,l=!0)}for(l=!0;g&&l;){l=!1;n=-1;r=0;for(q=0;q<h.length;++q)p=h[q],p>r&&(n=q,r=p);0<=n&&(--h[n],--g,l=!0)}g=0;for(l=0;l<h.length;++l)g+=h[l]}if(k&&g<this.ur)for(l=this.ur-g,g=Math.floor(l/k),k=l%k,l=0;l<h.length;++l)n=h[l],this.vf.length>l&&this.vf[l].he&&(n+=g,k&&(++n,--k),h[l]=n);k=[];for(var t of f){f=0;for(g=0;g<h.length;++g)f+=Math.max(h[g],g<t.length?t[g]:0);k.push(f)}d=new B(d);
for(t=0;t<this.dj.length;++t){f=this.dj[t];l=k[t]>this.ur;g="";for(n=0;n<f.ub.length;++n){var u=f.ub[n],w=h[n];(r=n==f.ub.length-1)||(u+=" ");q=this.vf.length>n&&"undefined"!=typeof this.vf[n].hc?this.vf[n].hc:0;if(l){w=this.ud?v(g):g.length;p=this.ud?v(u):u.length;if(w%this.ur+p>this.ur){u=u.split(" ");let d=w;for(let g=0;g<u.length;++g){let h=u[g],f=this.ud?v(h):h.length,k=0==g?0:1;f>this.ur?d+=f+k:d%this.ur+k+f>this.ur?(h=" ".repeat(this.ur-d%this.ur-k)+h,u[g]=h,d+=this.ud?v(h):h.length):d+=k+
f}u=u.join(" ")}r?(w=this.ur*(Math.floor(p/this.ur)+1)-w%this.ur,w<p&&(w+=this.ur)):w=0}g=1==q?g+this.vp(u,w):0!=q||r?g+u:g+this.vq(u,w)}if(g.length>this.ur){l=[];for(n=0;n<Math.floor(g.length/this.ur);++n)l.push(g.substring(n*this.ur,(n+1)*this.ur));g=l.join("\n")}d.hy(g,f.ht);t+1<this.dj.length&&d.hy("\n",f.ht)}d.ty()}hq(){let d=[];this.em((h)=>d.push(h));return d.join("")}vq(d,h){let f=this.ud?v(d):d.length;h>f&&(d+=" ".repeat(h-f));return d}vp(d,h){let f=this.ud?v(d):d.length;h>f&&(d=" ".repeat(h-
f)+d);return d}}f.gz=D;f.hx=function(d,h,f=[]){h=new D(h,f);for(const f of d)h.hn(...f);return h.hq()};f.hk=y;f.hl=function(d,h){d=d.split("\n");const f=[];for(const k of d)f.push(y(k,h));return f.join("\n")};f.createElement=x;f.gl=function(d){console.log("Toast: "+d);"undefined"!==typeof Android&&null!==Android?Android.showToast(d):alert(d)};f.wc=function(d,h="auto"){let f=d.parentElement;if(f){var m=$(f.firstChild).offset().top-$(f).offset().top+f.scrollTop;m=$(d).offset().top-$(f).offset().top+
f.scrollTop-m;m<f.scrollTop&&d.parentElement.scrollTo({top:m,behavior:h})}};f.wg=function(d,h="auto"){var f=d.parentElement,m=$(f.firstChild).offset().top-$(f).offset().top+f.scrollTop;m=$(d).offset().top-$(f).offset().top+f.scrollTop-m;f=$(f).height();let g=$(d).outerHeight();d.parentElement.scrollTo({top:m+g-f,behavior:h})};f.gc=C;f.rl=function(d,f,k,m){const g=new Date;g.setMilliseconds(0);let h=new Date(g.getTime());h.setHours(d,f,k);const l=()=>{try{m()}catch(p){}let g=new Date;g.setDate(g.getDate()+
1);g.setHours(d,f,k);C(g.getTime(),l)};(g.getHours()>d||g.getHours()==d&&g.getMinutes()>f||g.getHours()==d&&g.getMinutes()==f&&g.getSeconds()>k)&&h.setDate(h.getDate()+1);C(h.getTime(),l)};f.jf=function(d){return"[object Array]"===Object.prototype.toString.call(d)};class J{constructor(d){this.wq=d;this.wo=0}gk(d){this.wo&&clearTimeout(this.wo);"undefined"==typeof d&&(d=this.wq);this.wo=setTimeout(()=>this.wo=0,d)}gj(){return 0==this.wo}}f.ff=J;class L{constructor(d,f){this.qk=d;this.gi=f}gb(){this.wo||
this.wr()}bm(){this.wo&&(clearTimeout(this.wo),this.wo=null)}gk(){this.bm();this.wr()}wr(){this.wo=setTimeout(()=>{this.wo=null;this.gi()},1E3*this.qk)}}f.pd=L;class E{constructor(d,f,k){this.qk=d;this.wt=f;this.gi=k}gb(){this.wo||(this.ws(),this.wt&&this.gi())}bm(){this.wo&&(clearInterval(this.wo),this.wo=null)}gk(){this.bm();this.ws()}ws(){this.wo=setInterval(this.gi,1E3*this.qk)}}f.pb=E;f.un=v;f.vt=function(d){if(!d)throw"Assertion failed.";};f.lg=function(d,f){d=d.querySelectorAll("input, select, textarea");
for(let g=0;g<d.length;++g){var h=d[g];if(h.name&&"undefined"!=typeof f[h.name]){var m=f[h.name];if("checkbox"==h.type||"radio"==h.type)h.checked=h.value==f[h.name];else if("select-multiple"==h.type){m="[object Array]"===Object.prototype.toString.call(m)?m:[m];h=h.options;for(let d=0;d<h.length;++d){let g=h[d];g.selected=-1!=m.indexOf(g.value)}}else h.value=f[h.name]}}};f.le=function(d,f){d=d.querySelectorAll("input, select, textarea");let h={};for(let k=0;k<d.length;++k){let g=d[k];if(g.name)if("checkbox"==
g.type||"radio"==g.type)g.checked&&(h[g.name]=g.value);else if("select-multiple"==g.type){g.name.replace(/\[\]$/,"");let d=[];for(let f=0;f<g.options.length;++f)g.options[f].selected&&d.push(g.options[f].value);d.length&&(h[g.name]=d)}else"submit"==g.type?f&&g==f&&(h[g.name]=g.value):h[g.name]=g.value?g.value:""}return h};f.no=function(d){const f=[];for(let h in d)f.push(h+"="+encodeURIComponent(d[h]));return f.join("&")};class F{constructor(d){d&&(this.xe=x("audio",{src:d,style:{display:"none"}}))}tg(d){stop();
this.xe?this.xe.src!=d&&(this.xe.src=d):this.xe=x("audio",{src:d,style:{display:"none"}})}th(){this.xe&&(this.bm(),this.xe.play())}bm(){this.xe&&(this.xe.pause(),this.xe.currentTime=0)}xg(){this.xe&&this.xe.pause()}me(){this.xe&&this.xe.play()}}f.te=F})(cjt||(cjt={}));const np=29,ri=1,qy="613-663-6846 ext. 2";let app;var Android;(function(f){})(Android||(Android={}));
$(window).on("load",()=>{Android.version&&Android.version()==rt_api_version?(app=new b.Ok(rt_history),$("body")[0].appendChild(app.f)):(Android.showToast("The current app version is obsolete. Updating..."),Android.updateApp("https://tablet.menu.ca/download/app-release.apk"))});const __java_promises={};
function mj(f){let y=null;f.lock();try{if(f.complete()){let x=f.getValue();y=new Promise((f,v)=>f(JSON.parse(x)))}else{let x=f.getId();y=new Promise((f,v)=>{__java_promises[x]=f})}}catch(x){}f.unlock();return y}let pq=new b.sq;
