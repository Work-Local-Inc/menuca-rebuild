(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[631],{5467:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/test-payment",function(){return s(9222)}])},9222:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return TestPaymentPage}});var n=s(5893),r=s(7294),a=s(2859),l=s(6664),o=s(3454);let c=(0,a.J)(o.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY||""),PaymentForm=()=>{var e;let t=(0,l.useStripe)(),s=(0,l.useElements)(),[a,o]=(0,r.useState)(!1),[c,i]=(0,r.useState)(null),handleSubmit=async e=>{if(e.preventDefault(),t&&s){o(!0),i(null);try{console.log("\uD83C\uDFAF Creating payment intent...");let e=await fetch("/api/create-payment-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:1.15,currency:"cad",orderData:{customer_name:"Tablet Test Customer",customer_phone:"555-TEST-A19",restaurant_id:"A19"}})}),{client_secret:n,payment_intent_id:r}=await e.json();console.log("\uD83D\uDCB3 Payment intent created:",r);let a=s.getElement(l.CardElement);if(!a)throw Error("Card element not found");console.log("\uD83C\uDFAF Confirming payment...");let{error:o,paymentIntent:c}=await t.confirmCardPayment(n,{payment_method:{card:a,billing_details:{name:"Tablet Test Customer",email:"tablet-test@menuca.com"}}});o?(console.error("❌ Payment failed:",o),i({success:!1,error:o.message,type:"payment_error"})):(null==c?void 0:c.status)==="succeeded"&&(console.log("✅ Payment succeeded!",c.id),i({success:!0,payment_intent:c.id,amount:c.amount,message:"Payment successful! Webhook should trigger tablet integration.",instructions:["\uD83C\uDFAF Payment completed successfully","\uD83D\uDCE1 Webhook should trigger tablet integration","\uD83D\uDCF1 Check A19 tablet for air horn notification","\uD83C\uDFB5 Order should appear on tablet screen"]}))}catch(e){console.error("❌ Payment test error:",e),i({success:!1,error:e instanceof Error?e.message:"Unknown error",type:"system_error"})}o(!1)}};return(0,n.jsxs)("div",{className:"max-w-md mx-auto p-6 bg-white rounded-lg shadow-lg",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold mb-6 text-center",children:"\uD83C\uDFAF A19 Tablet Test"}),(0,n.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Test Payment ($1.15 CAD)"}),(0,n.jsx)("div",{className:"border rounded p-3",children:(0,n.jsx)(l.CardElement,{options:{style:{base:{fontSize:"16px",color:"#424770","::placeholder":{color:"#aab7c4"}}}}})}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Use test card: 4242 4242 4242 4242, any future date, any CVC"})]}),(0,n.jsx)("button",{type:"submit",disabled:!t||a,className:"w-full py-2 px-4 rounded font-medium ".concat(a?"bg-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"),children:a?"\uD83D\uDD04 Processing...":"\uD83C\uDFAF Test A19 Tablet Integration"})]}),c&&(0,n.jsxs)("div",{className:"mt-6 p-4 rounded ".concat(c.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:[(0,n.jsx)("h3",{className:"font-semibold ".concat(c.success?"text-green-800":"text-red-800"),children:c.success?"✅ Success!":"❌ Error"}),c.success?(0,n.jsxs)("div",{className:"text-sm text-green-700 mt-2",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Payment ID:"})," ",c.payment_intent]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Amount:"})," $",(c.amount/100).toFixed(2)," CAD"]}),(0,n.jsxs)("div",{className:"mt-3",children:[(0,n.jsx)("p",{className:"font-medium",children:"Next Steps:"}),(0,n.jsx)("ul",{className:"list-disc list-inside space-y-1 text-xs",children:null===(e=c.instructions)||void 0===e?void 0:e.map((e,t)=>(0,n.jsx)("li",{children:e},t))})]})]}):(0,n.jsx)("p",{className:"text-sm text-red-700 mt-2",children:c.error})]}),(0,n.jsxs)("div",{className:"mt-6 text-xs text-gray-500",children:[(0,n.jsx)("p",{children:(0,n.jsx)("strong",{children:"How it works:"})}),(0,n.jsxs)("ol",{className:"list-decimal list-inside space-y-1 mt-1",children:[(0,n.jsx)("li",{children:"Complete test payment above"}),(0,n.jsx)("li",{children:"Stripe webhook triggers our tablet integration"}),(0,n.jsx)("li",{children:"Order gets sent to tablet.menu.ca"}),(0,n.jsx)("li",{children:"A19 tablet picks up order and sounds air horn"}),(0,n.jsx)("li",{children:"Check browser console and tablet for results"})]})]})]})};function TestPaymentPage(){return(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,n.jsx)(l.Elements,{stripe:c,children:(0,n.jsx)(PaymentForm,{})})})}}},function(e){e.O(0,[774,447,888,179],function(){return e(e.s=5467)}),_N_E=e.O()}]);