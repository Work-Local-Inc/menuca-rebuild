"use strict";exports.id=928,exports.ids=[928],exports.modules={928:(e,t,o)=>{o.d(t,{j2:()=>formatOrderForTablet,rD:()=>sendOrderToTablet});let r="https://tablet.menu.ca";function formatOrderForTablet(e,t){let o=new Date,r=new Date(o.getTime()+27e5);return{ver:3,id:"A19",restaurant_id:"A19",delivery_type:"pickup"===e.delivery_type?2:1,comment:e.delivery_instructions||e.notes||"",payment_method:e.payment?.method||"Credit Card",payment_cc_ends:e.payment?.stripe_payment_id?.slice(-4)||"",payment_status:e.payment?.status==="succeeded"||e.payment?.status==="completed",order_count:1,delivery_time:Math.floor(r.getTime()/1e3),delivery_time_hr:r.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),discount_code:e.coupon_code||"",address:{name:e.customer?.name||e.customer_name||"Customer",address1:e.address?.street||e.delivery_address?.street||"Address",address2:e.address?.unit||e.delivery_address?.unit||"",postal_code:e.address?.postal_code||e.delivery_address?.postal_code||"K1A0A6",phone:e.customer?.phone||e.customer_phone||"555-1234",extension:e.address?.extension||""},order:(e.items||[]).map(e=>({item:e.name||e.title||"Menu Item",type:e.category||"food",qty:e.quantity||1,price:Math.round(100*(e.price||0)),special_instructions:e.special_instructions||e.notes||"",ingredients:(e.ingredients||e.modifiers||[]).map(e=>({item:e.name||e.title,type:"ingredient",qty:e.quantity||1,price:Math.round(100*(e.price||0))}))})),price:{subtotal:Math.round(100*(e.totals?.subtotal||e.subtotal||0)),delivery:Math.round(100*(e.totals?.delivery_fee||e.delivery_fee||0)),convenience:Math.round(100*(e.totals?.service_fee||e.service_fee||0)),discount:Math.round(100*(e.totals?.discount||e.discount||0)),tip:Math.round(100*(e.totals?.tip||e.tip||0)),total:Math.round(100*(e.totals?.total||e.total||0)),taxes:{HST:Math.round(100*(e.totals?.tax||e.tax||0))}},deal:e.deal?{name:e.deal.name,discount:Math.round(100*e.deal.discount)}:void 0,coupon:e.coupon?{name:e.coupon.name,items:e.coupon.items||[]}:void 0}}async function sendOrderToTablet(e,t){try{console.log(`üöÄ Implementing sendOrder() - sending order ${t} to tablet.menu.ca...`);let o=formatOrderForTablet(e,t);console.log("\uD83D\uDCE6 Sending v3 schema order:",JSON.stringify(o,null,2));let s=null;for(let e of["/v3/order","/v3/orders","/v3/send","/order","/orders","/send","/api/v3/sendOrder","/api/orders","/sendOrder","/action.php"])try{console.log(`üéØ Trying endpoint: ${r}${e}`);let s=await fetch(`${r}${e}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","User-Agent":"MenuCA-Platform/1.0"},body:JSON.stringify(o)}),n=await s.text();if(console.log(`üì° ${e} response: ${s.status} - ${n.substring(0,200)}...`),s.ok)return console.log(`‚úÖ SUCCESS! Order ${t} sent via ${e} (status: ${s.status})`),{success:!0,message:`Order sent successfully via ${e} - Status: ${s.status}`,order_id:t,response_data:n||"Empty response (normal for action.php)",endpoint_used:e}}catch(t){console.log(`‚ùå ${e} failed:`,t),s=t;continue}return{success:!1,message:`All tablet.menu.ca endpoints failed. Last error: ${s}`,order_id:t}}catch(e){return console.error(`‚ùå Failed to send order ${t} to tablet:`,e),{success:!1,message:e instanceof Error?e.message:"Unknown error",order_id:t}}}}};