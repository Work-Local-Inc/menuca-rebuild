"use strict";(()=>{var e={};e.id=9661,e.ids=[9661],e.modules={9379:e=>{e.exports=require("@mendable/firecrawl-js")},1287:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},2293:(e,s,i)=>{i.r(s),i.d(s,{config:()=>d,default:()=>o,routeModule:()=>p});var a={};i.r(a),i.d(a,{default:()=>handler});var t=i(1802),n=i(7153),r=i(6249),l=i(9379),c=i.n(l);function isPotentialItem(e){return e.length>3&&!e.includes("$")&&!e.includes("|")&&!e.includes("\xbb")&&!e.toLowerCase().includes("choisissez")&&!e.toLowerCase().includes("choose")&&!e.startsWith("[")&&!e.startsWith("*")&&!e.includes("Haut")&&!e.includes("![")&&!e.includes("](")&&!e.includes("Loading")&&!e.includes("close.png")&&!e.includes(".gif")&&!e.includes(".png")&&!e.includes("---")&&"*"!==e.trim()&&"* * *"!==e.trim()}let u=new(c())({apiKey:"fc-ac838657c3104fb78ac162ef8792fc97"});async function handler(e,s){if("POST"!==e.method)return s.status(405).json({error:"Method not allowed"});let{url:i}=e.body;try{console.log("\uD83D\uDD77️ Scraping:",i);let e=await u.scrape(i,{formats:["markdown","html"],includeTags:["h1","h2","h3","h4","table","div","span","p"],excludeTags:["script","style"],waitFor:3e3}),a=e.markdown||"",t=a.split("\n").slice(0,100),n=function(e,s){let i=e.split("\n"),a=new Map,t="Menu Items",n="Restaurant";e.includes("Milano")?n="Milano Pizzeria":e.includes("Tony's")?n="Tony's Pizza":e.includes("Xtreme")&&(n="Xtreme Pizza");let r="Pizza";e.includes("Poutine")&&e.includes("Sous-Marin")&&(r="Pizza & Canadian");for(let e=0;e<i.length;e++){let s=i[e].trim();if(!(!s||s.includes("| ---")||s.includes("[](#)")||s.includes("Choisissez cet item")||s.includes("Choose this item"))){if(function(e){return!(e.includes("$")||e.includes("|"))&&!(e.length>60)&&["Pizza","Poutine","Sandwich","Burger","Nachos","P\xe2tes","Pasta","Dessert","Breuvage","Beverage","Drink","Accompagnement","Side","Appetizer","Entr\xe9e","Wings","Salad","Combo","Special","Menu","Submarine","Sub","Wrap","Vegan","V\xe9g\xe9"].some(s=>e.toLowerCase().includes(s.toLowerCase()))}(s)){var l;t=s.replace(/^(Nos |Our |Les |The )/i,"").replace(/\s*Haut\s*$/i,"").trim();continue}if(isPotentialItem(s)){let s=function(e,s){let i=e[s].trim(),a="",t=[],n=0;for(let i=1;i<=10&&s+i<e.length;i++){let r=e[s+i].trim();if(r&&!r.includes("$")&&!r.includes("|")&&!r.includes("\xbb")&&isPotentialItem(r))break;if(a||!r||r.includes("$")||r.includes("|")||r.includes("\xbb")||(a=r,n=i),r.includes("$")&&r.includes("|")){let e=r.split("|");for(let s=0;s<e.length-1;s++)if(e[s].includes("\xbb")&&e[s+1].includes("$")){let i=e[s].replace("\xbb","").trim(),a=e[s+1].match(/\$\s*([\d.]+)/);a&&t.push({size:i,price:parseFloat(a[1])})}n=i}if(r.includes("$")&&!r.includes("\xbb")){let e=r.match(/\$\s*([\d.]+)/);e&&(t.push({size:"Regular",price:parseFloat(e[1])}),n=i)}}return t.length>0?{name:i,description:a||"",prices:t,linesProcessed:n}:null}(i,e);s&&s.prices.length>0&&(a.has(t)||a.set(t,[]),a.get(t).push(s),e+=s.linesProcessed||0)}}}let c=[];a.forEach((e,s)=>{e.length>0&&c.push({name:s,items:e})});let u=function(e){let s=new Map,i={"Pizza au fromage":"Pizzas","Pizza Pepperoni":"Pizzas",Pizza:"Pizzas","Menu Pizza":"Pizzas","Pizza V\xe9g\xe9":"Vegan Pizzas","Pizza V\xe9g\xe9talienne":"Vegan Pizzas","Poutine Classique":"Poutines",Poutine:"Poutines","Nos Poutines":"Poutines","Les Sandwiches":"Sandwiches & Subs","Sous-Marin":"Sandwiches & Subs",Sandwich:"Sandwiches & Subs",Burger:"Burgers","Nos Nachos":"Nachos",Nachos:"Nachos",Pâtes:"Pasta","Nos P\xe2tes":"Pasta",Pasta:"Pasta",Accompagnement:"Sides & Appetizers",Trempettes:"Sides & Appetizers",Wings:"Wings",Ailes:"Wings",Breuvage:"Beverages",Beverage:"Beverages",Drink:"Beverages"};e.forEach(e=>{let a=e.name;Object.entries(i).forEach(([s,i])=>{e.name.toLowerCase().includes(s.toLowerCase())&&(a=i)}),s.has(a)||s.set(a,[]),s.get(a).push(...e.items)});let a=[];return s.forEach((e,s)=>{let i=new Map;e.forEach(e=>{i.has(e.name)||i.set(e.name,e)}),a.push({name:s,items:Array.from(i.values())})}),a}(c);return{restaurant:{name:n,cuisine:r,website:s},categories:u}}(a,i);return s.status(200).json({success:!0,scraped:{markdownLength:a.length,htmlLength:(e.html||"").length,first100Lines:t,hasTableData:a.includes("|"),hasPriceData:a.includes("$"),hasSizeData:a.includes("\xbb")},parsed:{restaurant:n.restaurant,categoriesCount:n.categories.length,categories:n.categories.map(e=>({name:e.name,itemCount:e.items.length,items:e.items.slice(0,3).map(e=>({name:e.name,description:e.description,prices:e.prices}))}))}})}catch(e){return console.error("Debug error:",e),s.status(500).json({error:e.message,stack:e.stack})}}let o=(0,r.l)(a,"default"),d=(0,r.l)(a,"config"),p=new t.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/debug-scraper",pathname:"/api/debug-scraper",bundlePath:"",filename:""},userland:a})}};var s=require("../../webpack-api-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),i=s.X(0,[4222],()=>__webpack_exec__(2293));module.exports=i})();