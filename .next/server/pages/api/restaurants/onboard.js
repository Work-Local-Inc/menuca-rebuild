"use strict";(()=>{var e={};e.id=1860,e.ids=[1860],e.modules={2885:e=>{e.exports=require("@supabase/supabase-js")},1287:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6078:(e,r,a)=>{a.r(r),a.d(r,{config:()=>_,default:()=>c,routeModule:()=>p});var t={};a.r(t),a.d(t,{config:()=>d,default:()=>handler});var s=a(1802),n=a(7153),o=a(6249),u=a(2885);let i=require("uuid"),l=(0,u.createClient)(process.env.NEXT_PUBLIC_SUPABASE_URL,(process.env.SUPABASE_SERVICE_ROLE_KEY||"").replace(/\s/g,"")),d={maxDuration:60};async function handler(e,r){if("POST"!==e.method)return r.status(405).json({success:!1,error:"Method not allowed"});try{let{profile:a,legacy_url:t}=e.body;console.log("\uD83C\uDFEA Creating new restaurant:",a.name);let s=(0,i.v4)(),n=`${a.name.toLowerCase().replace(/[^a-z0-9]/g,"-")}-${Date.now()}`,{data:o,error:u}=await l.from("restaurants").insert({id:s,tenant_id:n,owner_id:"onboarding-user",name:a.name,description:a.description||`Delicious ${a.cuisine_type} restaurant`,cuisine_type:a.cuisine_type,phone:a.phone,email:a.email,address:`${a.address}, ${a.city}, ${a.state}`,website:a.website||t,logo_url:a.logo_url?.startsWith("blob:")?null:a.logo_url||null,banner_url:a.header_image_url?.startsWith("blob:")?null:a.header_image_url||null,status:"active",featured:!1,is_open:!0,is_featured:!1}).select().single();if(u)return console.error("Restaurant creation error:",u),r.status(500).json({success:!1,error:"Failed to create restaurant",details:u});return console.log("✅ Restaurant created successfully:",s),r.status(200).json({success:!0,restaurant:{id:s,name:a.name,status:"active",menu_url:`/menu/${s}`,management_url:`/restaurant/${s}/dashboard`},menu_import:null,next_steps:["✅ Restaurant created successfully","✅ Menu import will start automatically","✅ Your restaurant is now LIVE and ready for orders!"]})}catch(e){return console.error("Onboarding error:",e),r.status(500).json({success:!1,error:"Internal server error",message:e instanceof Error?e.message:"Unknown error"})}}let c=(0,o.l)(t,"default"),_=(0,o.l)(t,"config"),p=new s.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/restaurants/onboard",pathname:"/api/restaurants/onboard",bundlePath:"",filename:""},userland:t})}};var r=require("../../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),a=r.X(0,[4222],()=>__webpack_exec__(6078));module.exports=a})();