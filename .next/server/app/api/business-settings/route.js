(()=>{var e={};e.id=8627,e.ids=[8627],e.modules={2213:e=>{function webpackEmptyContext(e){var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}webpackEmptyContext.keys=()=>[],webpackEmptyContext.resolve=webpackEmptyContext,webpackEmptyContext.id=2213,e.exports=webpackEmptyContext},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3685:e=>{"use strict";e.exports=require("http")},2241:e=>{"use strict";e.exports=require("https")},4577:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},965:(e,s,t)=>{"use strict";t.r(s),t.d(s,{headerHooks:()=>g,originalPathname:()=>I,requestAsyncStorage:()=>_,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>b,staticGenerationBailout:()=>E});var r={};t.r(r),t.d(r,{GET:()=>GET,POST:()=>d,PUT:()=>PUT}),t(8976);var n=t(884),i=t(6132),o=t(5798),u=t(8771);let a=process.env.NEXT_PUBLIC_SUPABASE_URL||"https://nthpbtdjhhnwfxqsxbvy.supabase.co",l=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im50aHBidGRqaGhud2Z4cXN4YnZ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUyNzM0ODQsImV4cCI6MjA3MDg0OTQ4NH0.CfgwjVvf2DS37QguV20jf7--QZTXf6-DJR_IhFauedA";(0,u.createClient)(a,l);let p=(0,u.createClient)(a,process.env.SUPABASE_SERVICE_ROLE_KEY||"placeholder_service_role_key");function getBusinessIdFromRequest(e){let s=new URL(e.url),t=s.searchParams.get("business_id")||"";if(t)return t;let r=e.headers.get("x-business-id")||"";if(r)return r;let n=process.env.NEXT_PUBLIC_DEFAULT_BUSINESS_ID||"";return n||null}async function GET(e){let s=getBusinessIdFromRequest(e);if(!s)return o.Z.json({error:"missing_business_id",message:"No business identifier provided. Pass ?business_id=... or header x-business-id, or set NEXT_PUBLIC_DEFAULT_BUSINESS_ID."},{status:400});let t=process.env.NEXT_PUBLIC_DEFAULT_BUSINESS_ID;if(t&&s!==t)return o.Z.json({error:"forbidden",message:"Business not permitted in this environment"},{status:403});let{data:r,error:n}=await p.from("businesses").select("*").eq("id",s).single();if(n){let e=n.message||"Unknown error",s=n.code||"";return e.includes("Could not find the table")||"42P01"===s?o.Z.json({error:"missing_table",message:"Table 'public.businesses' does not exist. Run the migration in sql/create-businesses-table.sql on your Supabase project."},{status:424}):o.Z.json({error:"query_failed",message:e},{status:500})}return o.Z.json({business:r},{status:200})}async function PUT(e){let s=getBusinessIdFromRequest(e);if(!s)return o.Z.json({error:"missing_business_id"},{status:400});let t=process.env.NEXT_PUBLIC_DEFAULT_BUSINESS_ID;if(t&&s!==t)return o.Z.json({error:"forbidden",message:"Business not permitted in this environment"},{status:403});let r=await e.json(),n={id:s,name:r.name??"",phone:r.phone??null,timezone:r.timezone??null,currency:r.currency??"CAD",is_open:r.is_open??!0,order_limit:r.order_limit??0,address:r.address??null,slug:r.slug??null},{data:i,error:u}=await p.from("businesses").upsert(n,{onConflict:"id"}).select("*").single();if(u){let e=u.message||"Unknown error",s=u.code||"";return e.includes("Could not find the table")||"42P01"===s?o.Z.json({error:"missing_table",message:"Table 'public.businesses' does not exist. Run the migration in sql/create-businesses-table.sql on your Supabase project."},{status:424}):o.Z.json({error:"mutation_failed",message:e},{status:500})}return o.Z.json({business:i},{status:200})}let d=PUT,c=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/business-settings/route",pathname:"/api/business-settings",filename:"route",bundlePath:"app/api/business-settings/route"},resolvedPagePath:"/Users/brianlapp/Documents/GitHub/menuca-rebuild/app/api/business-settings/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:_,staticGenerationAsyncStorage:b,serverHooks:m,headerHooks:g,staticGenerationBailout:E}=c,I="/api/business-settings/route"}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[3955,8771],()=>__webpack_exec__(965));module.exports=t})();